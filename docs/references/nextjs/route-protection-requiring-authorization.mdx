---
title: Requiring Authorization for Route protection | Next.js
description: Learn how to protect the B2B (Business to Business) routes in your Next.js application that require authorization.
---

# Required Authorization for Route protection 

Whether you're in the App Router, Pages Router, or Middleware, Clerk provides access to a standardized [Auth](/docs/references/nextjs/authentication-object) object that you can use to require authorication throughout your application. This allows you to integrate your route protection with Clerk's [Organizations](http://localhost:4003/docs/organizations/overview) and the roles and permissions available with organizations. Below, we explain how to access and use the Auth object.

If you want to learn about protecting routes based on authentication, see the [requiring authentication](/docs/references/nextjs/route-protection-requiring-authentication) guide.


## App Router

### Protect a layout or page

You can use `protect()` and `has()` in a route's `layout.tsx` to protect based on [permissions](/docs/organizations/verify-user-permissions) or [roles](/docs/organizations/verify-user-permissions#authorize-with-roles.

<CodeBlockTabs type="router" options={["protect()", "has()"]}>

```tsx filename="app/dashboard/manage-users/layout.tsx" 
import { auth } from "@clerk/nextjs/server";

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  auth().protect({ permission: "org:sys_memberships:manage" })
  return (
    <div>{children}</div>
  )
}
```

```tsx filename="app/dashboard/manage-users/layout.tsx" 
import { auth } from '@clerk/nextjs/server'
import { redirect } from 'next/navigation'

export default async function Layout({ children }: { children: React.ReactNode }) {
  if (!auth().has({ role: "org:admin" })) {
    redirect("/")
  }
  return <>{children}</>
}
```
</CodeBlockTabs>


You can use `protect()` and `has()` in a specific page to protect using roles and permissions from organizations.

<CodeBlockTabs type="router" options={["protect()", "has()"]}>
```tsx filename="app/manage-users/page.tsx"
import { auth } from "@clerk/nextjs/server"

export default function Page() {

  auth().protect({ permission: "org:sys_memberships:manage" })

  return (
    <p>This is a page</p>
  )
}
```

```tsx filename="app/dashboard/manage-users/page.tsx" 
import { auth } from '@clerk/nextjs/server'

export default function Page() {

if (!auth().has({ role: "org:admin" })) {
    return <p>You do not have permission to view this page.</p>
  }

  return (
    <>
      <h1>Manage Users</h1>
      <p>Manage your users, invite new users or ban users</p>
    </>
  );
}
```
</CodeBlockTabs>

### Protect your Route Handlers and Server Actions

You can use auth().protect() to check permissions in your Route Handlers or Server actions, allowing you to protect queries and mutations.

```tsx filename="/app/api/dashboard/route.ts"
import { auth } from "@clerk/nextjs/server";

export async function GET() {

  // If there is no signed in user, this will return an error
  auth().protect({ permission: "org:sys_memberships:manage" })

  // Perform your Route Handler logic here

  return Response.json({ userId: auth().userId })
}
```


## Pages Router

### Protect a page

You can protect a page in your application by checking either the permissions or the role that the user has. 

```tsx filename="/pages/dashboard/manage-memberships"
import { useAuth } from "@clerk/nextjs";

export default function Page() {

  const { has, isLoaded } = useAuth()

  if (!isLoaded) return "Loading..."

  if (!has({ permission: "org:sys_memberships:manage" })) {
    return <p>You do not have access to this page</p>
  }

  return (
    <>
      <h1>Manage Memberships</h1>
      <p>Use this page to manage the memberships in your organization<p>
    </>
  );
}
````

## Protect your application with Middleware

You an protect your routes in Middleware using [`clerkMiddleware()`](/docs/references/nextjs/clerk-middleware). `clerkMiddleware()` allows you select the routes you want to protect, and how you want to protect them. The example below is just protecting one route, but you can protect many routes.

This is just a simple example of `clerkMiddleware()`. Please see the clerkMiddleware documentation for detailed information on the options and configurations available.

```tsx filename="middleware.tsx"
import {
  clerkMiddleware,
  createRouteMatcher,
} from '@clerk/nextjs/server';

const isProtectedRoute = createRouteMatcher([
  '/dashboard'
]);

export default clerkMiddleware((auth, req) => {
  // Restricted to users with the org:sys_memberships:manage'
  // Logged out users will be redirected to sign-in route
  if (isProtectedRoute(req)) {
    auth().protect({ permission: "org:sys_memberships:manage" })
  }
}

export const config = {
  matcher: ['/((?!.*\\..*|_next).*)', '/', '/(api|trpc)(.*)'],
};
```


