---
title: Build a custom flow for managing SSO connections
description: Learn how to use the Clerk API to build a custom flow for adding and managing SSO connections
---

<Include src="_partials/custom-flows-callout" />

## Before you start

You must configure your application instance through the Clerk Dashboard for the SSO connections that you want to use.

- For social (OAuth) connection(s), see [the appropriate guide for your platform](/docs/authentication/social-connections/overview).
- For enterprise connection(s), see [the appropriate guide for your platform](/docs/authentication/enterprise-connections/overview).

This guide uses Discord, Google, and GitHub as examples.

## Build the custom flow

1. Edit the `options` array in the code below to add all of your enabled SSO connections.
1. The `OAuthStrategy` lists all of the strategies for the pre-configured SSO connections.
1. Custom SSO connections will use a strategy like `oauth_custom_<name>`. The `OAuthStrategy` type includes typing for custom providers. The code example below will need modifying to support custom providers.

```tsx {{ filename: 'app/account/manage-external-accounts/page.tsx', collapsible: true }}
'use client'

import { useUser } from '@clerk/nextjs'
import { OAuthStrategy } from '@clerk/types'
import { useRouter } from 'next/navigation'

const capitalize = (provider: string) => {
  return `${provider.slice(0, 1).toUpperCase()}${provider.slice(1)}`
}

export default function AddAccount() {
  const { isLoaded, user } = useUser()
  const router = useRouter()

  // List the options the user can select when adding a new external account
  // Edit this array to include all of your enabled SSO connections
  const options: OAuthStrategy[] = ['oauth_discord', 'oauth_google', 'oauth_github']

  // Handle adding the new external account
  const addSSO = async (strategy: OAuthStrategy) => {
    await user
      ?.createExternalAccount({
        strategy,
        redirectUrl: '/external-accounts',
      })
      .then((res) => {
        if (res.verification?.externalVerificationRedirectURL) {
          router.push(res.verification.externalVerificationRedirectURL.href)
        }
      })
      .catch((err) => {
        console.log('ERROR', err)
      })
      .finally(() => {
        console.log('redirected user to oauth provider')
      })
  }

  // Show a loading message until Clerk loads
  if (!isLoaded) return <p>Loading...</p>

  // Find the external accounts from the options array that the user has not yet added to their account
  // This prevents showing an 'add' button for existing external account types
  const unconnectedOptions = options.filter(
    (option) =>
      !user?.externalAccounts.some((account) => account.provider === option.replace('oauth_', '')),
  )

  return (
    <>
      <div>
        <p>Connected accounts</p>
        <table>
          <thead>
            <tr>
              <th>Provider</th>
              <th>Scopes</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {user?.externalAccounts.map((account) => {
              return (
                <tr key={account.id}>
                  <td>{capitalize(account.provider)}</td>
                  <td>{account.approvedScopes}</td>
                  <td>
                    {/* This example uses the `longMessage` returned by the API. You can use account.verification.error.code to determine the error and then provide your own message to the user. */}
                    {account.verification?.status === 'verified'
                      ? capitalize(account.verification?.status)
                      : account.verification?.error?.longMessage}
                  </td>
                  <td>
                    <button onClick={() => account.destroy()}>Remove</button>
                  </td>
                </tr>
              )
            })}
          </tbody>
        </table>
      </div>
      {unconnectedOptions.length > 0 && (
        <div>
          <p>Add a new external account</p>
          <ul>
            {unconnectedOptions.map((strategy) => {
              return (
                <li key={strategy}>
                  <button onClick={() => addSSO(strategy)}>
                    Add {capitalize(strategy.split('_')[1])}
                  </button>
                </li>
              )
            })}
          </ul>
        </div>
      )}
    </>
  )
}
```
