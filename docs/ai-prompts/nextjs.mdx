---
title: Next.js App Router Authentication
description: Comprehensive AI prompt for implementing Clerk authentication in Next.js 14+ applications using App Router
---

# Next.js App Router Authentication with Clerk

This prompt helps AI assistants guide you through implementing Clerk authentication in a Next.js application using the App Router.

## When to use this prompt

- Setting up a new Next.js 14+ project with Clerk
- Migrating from Pages Router to App Router with Clerk
- Implementing advanced authentication patterns
- Building multi-tenant applications

## The prompt

```text copyButton
You are an expert in Next.js App Router and Clerk authentication. Help me implement Clerk in my Next.js application following these guidelines:

## Core Principles
1. Always use App Router patterns (not Pages Router)
2. Implement authentication at the middleware level
3. Use server components by default, client components only when necessary
4. Follow Next.js 14+ best practices

## Setup Steps
1. Install required packages: @clerk/nextjs
2. Configure environment variables: NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY and CLERK_SECRET_KEY
3. Set up middleware.ts with clerkMiddleware
4. Wrap the app with ClerkProvider in the root layout

## Key Patterns
- Use auth() in server components for authentication checks
- Use currentUser() for fetching user data server-side
- Implement route protection with middleware
- Handle loading states with Suspense boundaries
- Manage sessions properly with Clerk's session management

## Security Considerations
- Never expose sensitive keys client-side
- Validate all user inputs
- Use Clerk's built-in CSRF protection
- Implement proper error boundaries

## Common Tasks
- Setting up sign-in/sign-up pages
- Protecting API routes
- Implementing organization features
- Managing user metadata
- Setting up webhooks

When providing code examples, always:
- Include proper TypeScript types
- Show error handling
- Include comments explaining the logic
- Follow Next.js naming conventions

[Add your specific Next.js prompt content here]
```

## Usage examples

### Setting up authentication

```typescript
// middleware.ts
import { clerkMiddleware, createRouteMatcher } from '@clerk/nextjs/server'

const isProtectedRoute = createRouteMatcher([
  '/dashboard(.*)',
  '/api/protected(.*)',
])

export default clerkMiddleware(async (auth, req) => {
  if (isProtectedRoute(req)) {
    await auth.protect()
  }
})

export const config = {
  matcher: [
    '/((?!.*\\..*|_next).*)',
    '/',
    '/(api|trpc)(.*)'
  ],
}
```

### Using authentication in server components

```typescript
// app/dashboard/page.tsx
import { auth, currentUser } from '@clerk/nextjs/server'
import { redirect } from 'next/navigation'

export default async function DashboardPage() {
  const { userId } = await auth()
  
  if (!userId) {
    redirect('/sign-in')
  }
  
  const user = await currentUser()
  
  return (
    <div>
      <h1>Welcome, {user?.firstName || 'User'}!</h1>
    </div>
  )
}
```

## Tips for AI tools

- When Cursor or Copilot suggests authentication code, ensure it uses the App Router patterns
- Always verify that sensitive operations happen on the server
- Check that TypeScript types are properly imported from `@clerk/nextjs`

## Related prompts

- [React Applications](/docs/ai-prompts/react)
- [Supabase Integration](/docs/ai-prompts/supabase)