---
title: Build a custom email/password authentication flow
description: Learn how to build a custom email/password sign-up and sign-in flow using Clerk's useSignUp() and useSignIn() hooks.
---

# Build a custom email/password authentication flow

<Callout type="danger">
  This guide is for users who want to build a *custom* user interface using the Clerk API. To authenticate users with email and password using a *prebuilt* UI, you should use Clerk's [Account Portal pages](/docs/account-portal/overview) or [prebuilt components](/docs/components/overview).
</Callout>

This guide will walk you through how to build a custom email/password sign-up and sign-in flow.

{/* TODO: Update these Steps when the Steps component can accept other headings. As of right now, Steps can only accept H3s. */}

<Steps>

### Enable email and password authentication

To use email and password authentication, you first need to enable these authentication strategies in the Clerk Dashboard.

1. Navigate to the Clerk Dashboard.
`. Go to **User & Authentication > [Email, Phone, and Username](https://dashboard.clerk.com/last-active?path=user-authentication/email-phone-username)** in the sidebar menu.
1. Ensure **Email address** is enabled. By default, the email address [verification method](/docs/authentication/configuration/sign-up-sign-in-options#verification-methods) is set to **Email code**. This means that when a user signs up using their email address and password, Clerk will send a one-time code to the user's email address. The user must then enter this code to verify their email and complete the sign-up process.
1. In the **Username** section, ensure that **Username** is disabled, or else the `create()` method will require a username to be passed in the params. If you would like to use usernames, you must handle collecting the username in your custom flow.
1. In the **Authentication strategies** section of this page, ensure **Password** is enabled.

### Create the email/password sign-up flow

To sign up a user using their email and password, you must:

1. Initiate the sign-up process by collecting the user's email address and password.
2. Prepare the email address verification, which sends a one-time code to the given address.
3. Attempt to complete the email address verification by supplying the one-time code.
4. If the email address verification is successful, set the newly created session as the active session.

<Tabs type="framework" items={["Next.js", "JavaScript"]}>
  <Tab>
    This example is written for Next.js App Router but it can be adapted for any React meta framework, such as Remix or Gatsby.

    ```jsx filename="app/sign-up/[[...sign-up]]/page.tsx"
    'use client';

    import * as React from 'react';
    import { useSignIn } from '@clerk/nextjs';
    import { useRouter } from 'next/navigation';

    export default function SignInForm() {
      const { isLoaded, signIn, setActive } = useSignIn();
      const [email, setEmail] = React.useState('');
      const [password, setPassword] = React.useState('');
      const [error, setError] = React.useState('');
      const router = useRouter();

      // Handle the submission of the sign-in form
      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        setError('');

        if (!isLoaded) {
          return;
        }

        // Start the sign-in process using the email and password provided
        try {
          const completeSignIn = await signIn.create({
            identifier: email,
            password,
          });

          // This is mainly for debugging while developing.
          if (completeSignIn.status !== 'complete') {
            console.log(JSON.stringify(completeSignIn, null, 2));
            setError(JSON.stringify(completeSignIn, null, 2));
          }

          // If sign-in process is complete, set the created session as active
          // and redirect the user
          if (completeSignIn.status === 'complete') {
            await setActive({ session: completeSignIn.createdSessionId });
            router.push('/');
          }
        } catch (err: any) {
          console.error(JSON.stringify(err, null, 2));
          setError(JSON.stringify(err, null, 2));
        }
      };

      // Display a form to capture the user's email and password
      return (
        <>
          <h1>Sign in</h1>
          <form onSubmit={(e) => handleSubmit(e)}>
            <div>
              <label htmlFor="email">Enter email address</label>
              <input
                onChange={(e) => setEmail(e.target.value)}
                id="email"
                name="email"
                type="email"
                value={email}
              />
            </div>
            <div>
              <label htmlFor="password">Enter password</label>
              <input
                onChange={(e) => setPassword(e.target.value)}
                id="password"
                name="password"
                type="password"
                value={password}
              />
            </div>
            <button type="submit">Sign in</button>
          </form>
          <p>{error}</p>
        </>
      );
    }
    ```
    </Tab>

    {/* TODO (Roy): Use CodeBlockTabs and add example for NPM Module vs window.Clerk (Script) - see the /docs/components/user-button update I did in this PR */}
    <Tab>
  ```html filename="your-app.html"
  <!DOCTYPE html>
  <html lang="en">

  <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Clerk JavaScript Email + Password</title>
  </head>

  <body>
      <h1>Clerk JavaScript Email + Password</h1>

      <div id="auth-signup">
          <input placeholder="email" id="email" type="email"></input>
          <input placeholder="password" id="password" type="password"></input>
          <button onclick="SignUp()">SignUp</button>

      </div>
      <div id="auth-verification" hidden="true">
          <input placeholder="code" id="code" type="text"></input>
          <button onclick="VerifyEmailAddress()">Verify</button>
      </div>

      <div id="user-button" />
      <script>
          const SignUp = async () => {
              const emailAddress = document.getElementById('email').value;
              const password = document.getElementById('password').value;
              const {client} = window.Clerk;
              try {
                  await client.signUp.create({
                      emailAddress,
                      password
                  });
                  await client.signUp.prepareEmailAddressVerification();
                  //hide signup form
                  document.getElementById('auth-signup').hidden = true;
                  //show verification form
                  document.getElementById('auth-verification').hidden = false;
              }
              catch (err) {
                  console.log(err)
              }
          };
          const VerifyEmailAddress = async () => {
              const code = document.getElementById('code').value;
              const {client, setActive} = window.Clerk;
              try {
                  // Verify the email address.
                  const verify = await client.signUp.attemptEmailAddressVerification({
                      code
                  });
                  // User is created. Now, set the session to active. session is never null.
                  await setActive({session: verify.createdSessionId})
              }

              catch (err) {
                  console.log(err)
              }
          }
      </script>
      // Script to load Clerk up
      <script src="src/script.js" async crossorigin="anonymous"></script>
  </body>

  </html>
  ```
  </Tab>
</Tabs>

### Create the email/password sign-in flow

To authenticate a user using their email and password, you must:

1. Initiate the sign-in process by collecting the user's email address and password.
2. Prepare the first factor verification.
3. Attempt to complete the first factor verification.
4. If the verification is successful, set the newly created session as the active session.

<Tabs type="framework" items={["Next.js", "JavaScript"]}>
  <Tab>
    This example is written for Next.js App Router but it can be adapted for any React meta framework, such as Remix or Gatsby.

    ```jsx  filename="app/sign-in/[[...sign-in]].page.tsx"
    'use client';

    import * as React from 'react';
    import { useSignUp } from '@clerk/nextjs';
    import { useRouter } from 'next/navigation';

    export default function Page() {
      const { isLoaded, signUp, setActive } = useSignUp();
      const [emailAddress, setEmailAddress] = React.useState('');
      const [password, setPassword] = React.useState('');
      const [verifying, setVerifying] = React.useState(false);
      const [code, setCode] = React.useState('');
      const [error, setError] = React.useState('');
      const router = useRouter();

      // Handle submission of the sign-up form
      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        setError('');

        if (!isLoaded) return;

        // Start the sign-up process using the email and password provided
        try {
          await signUp.create({
            emailAddress,
            password,
          });

          // Send the user an email with the verification code
          await signUp.prepareEmailAddressVerification({
            strategy: 'email_code',
          });

          // Set 'verifying' true to display second form
          // and capture the OTP code
          setVerifying(true);
        } catch (err: any) {
          console.error('Error:', JSON.stringify(err, null, 2));
          setError(JSON.stringify(err, null, 2));
        }
      };

      // Handle the submission of the verification form
      const handleVerify = async (e: React.FormEvent) => {
        e.preventDefault();
        setError('');

        if (!isLoaded) return;

        try {
          // Use the code the user provided to attempt verification
          const completeSignUp = await signUp.attemptEmailAddressVerification({
            code,
          });

          // This is mainly for debugging while developing.
          if (completeSignUp.status !== 'complete') {
            console.log(JSON.stringify(completeSignUp, null, 2));
            setError(JSON.stringify(completeSignUp, null, 2));
          }

          // If verification was completed, set the session to active
          // and redirect the user
          if (completeSignUp.status === 'complete') {
            await setActive({ session: completeSignUp.createdSessionId });
            router.push('/');
          }
        } catch (err: any) {
          console.error('Error:', JSON.stringify(err, null, 2));
          setError(JSON.stringify(err, null, 2));
        }
      };

      // Display the verification form to capture the OTP code
      if (verifying) {
        return (
          <>
            <h1>Verify your email</h1>
            <form onSubmit={handleVerify}>
              <label id="code">Enter your verification code</label>
              <input
                value={code}
                id="code"
                name="code"
                onChange={(e) => setCode(e.target.value)}
              />
              <button type="submit">Verify</button>
            </form>
            <p>{error}</p>
          </>
        );
      }

      // Display the initial sign-up form to capture the email and password
      return (
        <>
          <h1>Sign up</h1>
          <form onSubmit={handleSubmit}>
            <div>
              <label htmlFor="email">Enter email address</label>
              <input
                id="email"
                type="email"
                name="email"
                value={emailAddress}
                onChange={(e) => setEmailAddress(e.target.value)}
              />
            </div>
            <div>
              <label htmlFor="password">Enter password</label>
              <input
                id="password"
                type="password"
                name="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
              />
            </div>
            <div>
              <button type="submit">Next</button>
            </div>
          </form>
          <p>{error}</p>
        </>
      );
    }
    ```
  </Tab>

{/* TODO (Roy): Use CodeBlockTabs and add example for NPM Module vs window.Clerk (Script) - see the /docs/components/user-button update I did in this PR */}
  <Tab>
  ```html filename="your-app.html"
  <!DOCTYPE html>
  <html lang="en">

  <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Clerk JavaScript Email + Password</title>
  </head>

  <body>
      <h1>Clerk JavaScript Email + Password</h1>

      <div id="auth-signin">
          <input placeholder="email" id="email" type="email"></input>
          <input placeholder="password" id="password" type="password"></input>
          <button onclick="SignIn()">SignIn</button>

      </div>
      <script>
          const SignIn = async () => {
              const emailAddress = document.getElementById('email').value;
              const password = document.getElementById('password').value;
              const {client} = window.Clerk;
              try {
                const signInAttempt = await client.signIn.create({
                      emailAddress,
                      password
                  });
                if (signInAttempt.status === "complete") {
                  await setActive({ session: signInAttempt.createdSessionId });
                  // Add logic to redirect the user how you see fit.
                }
                else {
                  /*Investigate why the sign-in hasn't completed */
                  console.log(signInAttempt);
                }
              }
              catch (err) {
                  console.log(err)
              }
          };
      </script>
      // Script to load Clerk up
      <script src="src/script.js" async crossorigin="anonymous"></script>
  </body>

  </html>
  ```
  </Tab>
</Tabs>
</Steps>
