---
title: Requiring authorization for route protection | Next.js
description: Learn how to protect the B2B (Business to Business) routes in your Next.js application that require authorization.
---

# Required authorization for route protection

Whether you're using the App Router, Pages Router, or Middleware, Clerk provides access to a standardized [`auth()`](/docs/references/nextjs/authentication-object) object that you can use to access authorization throughout your application. This allows you to protect routes based on Clerk's [organizations](/docs/organizations/overview) and their roles and permissions.

If you want to learn about protecting routes based on authentication, see the [requiring authentication](/docs/references/nextjs/route-protection-requiring-authentication) guide.

## App Router

### Protect a layout or page

You can protect an entire route tree or an individual page by using Clerk helpers based on [permissions](/docs/organizations/verify-user-permissions) or [roles](/docs/organizations/verify-user-permissions#authorize-with-roles). There are two methods that you can use depending on your use case:

- Using [`auth().protect()`](/docs/references/nextjs/auth#protect) if you want to redirect unauthenticated users to the sign in route automatically
- Using [`auth().has()`](/docs/references/nextjs/authentication-object#has) if you want more control over what your app does based on the authorization status

#### Protect a layout

<CodeBlockTabs type="router" options={["protect()", "has()"]}>
```tsx filename="app/dashboard/manage-users/layout.tsx"
import { auth } from "@clerk/nextjs/server";

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  auth().protect({ permission: "org:sys_memberships:manage" })

  return (
    <div>{children}</div>
  )
}
```

```tsx filename="app/dashboard/manage-users/layout.tsx"
import { auth } from '@clerk/nextjs/server'
import { redirect } from 'next/navigation'

export default async function Layout({ children }: { children: React.ReactNode }) {
  if (!auth().has({ role: "org:admin" })) {
    redirect("/")
  }
  return <>{children}</>
}
```
</CodeBlockTabs>

#### Protect a page

<CodeBlockTabs type="router" options={["protect()", "has()"]}>
```tsx filename="app/manage-users/page.tsx"
import { auth } from "@clerk/nextjs/server"

export default function Page() {

  auth().protect({ permission: "org:sys_memberships:manage" })

  return (
    <p>This is a page</p>
  )
}
```

```tsx filename="app/dashboard/manage-users/page.tsx"
import { auth } from '@clerk/nextjs/server'

export default function Page() {

if (!auth().has({ role: "org:admin" })) {
    return <p>You do not have permission to view this page.</p>
  }

  return (
    <>
      <h1>Manage Users</h1>
      <p>Manage your users, invite new users or ban users</p>
    </>
  );
}
```
</CodeBlockTabs>

### Protect your Route Handlers and Server Actions

{/* TODO: Add has example */}

You can use protect queries and mutations in your Route Handlers or Server Actions in two ways:

- `auth().protect()` if you want Clerk to automatically return an error
- `auth().has()` if you want to customize the behavior or error message

```tsx filename="/app/api/dashboard/route.ts"
import { auth } from "@clerk/nextjs/server";

export async function GET() {

  // If there is no signed in user, this will return an error
  auth().protect({ permission: "org:sys_memberships:manage" })

  // Perform your Route Handler logic here

  return Response.json({ userId: auth().userId })
}
```

## Pages Router

### Protect a page

You can protect a page using [`getServerSideProps()`](https://nextjs.org/docs/pages/building-your-application/data-fetching/get-server-side-props) when using Server Side Rendering, or with [`useAuth()`](/docs/references/react/use-auth) from the client side.

<Tabs type="router" items={["Server Side Rendered", "Client side"]}>
  <Tab>
  {/* TODO: Add getServerSideProps example */}
  </Tab>

  <Tab>
  Note that in the following example, all content is sent to the client. If JavaScript doesn't run, the user can see the content. If you need to protect sensitive content, use the "Server Side Rendered" example or [`clerkMiddleware()`](#protect-your-application-with-middleware) instead.

  ```tsx filename="/pages/dashboard/manage-memberships"
  import { useAuth } from "@clerk/nextjs";

  export default function Page() {

    const { has, isLoaded } = useAuth()

    if (!isLoaded) return "Loading..."

    if (!has({ permission: "org:sys_memberships:manage" })) {
      return <p>You do not have access to this page</p>
    }

    return (
      <>
        <h1>Manage Memberships</h1>
        <p>Use this page to manage the memberships in your organization</p>
      </>
    );
  }
  ```
  </Tab>
</Tabs>

## Protect your application with Middleware

You can protect your routes using Middleware with `clerkMiddleware()`, which allows you to select the routes you want to protect. See the [reference documentation](/docs/references/nextjs/clerk-middleware) for more information.
