---
title: Use Clerk with Next.js
description: Learn how to use Clerk to quickly and easily add secure authentication and user management to your Next.js application. Clerk works seamlessly on both client side and server side components.
---

# Add authentication and user management to your Next.js app with Clerk

## You will learn how to

* Install `@clerk/nextjs`
* Set up your environment keys
* Wrap your Next.js app in `<ClerkProvider />`
* Limit access to authenticated users
* Embed the `<UserButton />`

**Estimated time** 1 cup of coffee

### Prerequisites 

* [Set up Clerk](/docs/quickstarts/setup-clerk)
* [A Next.js project](https://nextjs.org/docs/getting-started/installation)

#### Get the finished project

<Tabs items={["App Router version", "Page Router version"]}>
  <Tab>
    [`github.com/clerkinc/clerk-next-app-router-starter`](https://github.com/clerkinc/clerk-next-app-router-starter)
  </Tab>
  <Tab>
    [`github.com/clerkinc/clerk-nextjs-starter`](https://github.com/clerkinc/clerk-nextjs-starter)
  </Tab>
</Tabs>

<Steps>

### Install `@clerk/nextjs`

Clerk's Next.js SDK gives you access to prebuilt components and hooks and [helpers](/docs/references/nextjs/overview) for Next.js API routes, server-side rendering, and Middleware. Install it by running the following command in your terminal:

<CodeBlockTabs options={['npm', 'yarn', 'pnpm']}>
  ```bash filename="terminal"
  npm install @clerk/nextjs
  ```

  ```bash filename="terminal"
  yarn add @clerk/nextjs
  ```

  ```bash filename="terminal"
  pnpm add @clerk/nextjs
  ```
</CodeBlockTabs>

### Set environment keys

In your Next.js project's root folder, you may have an `.env.local` file alongside `package.json` and other configuration files. If you don't see it, create it.

Add the following code to your `.env.local` file to set your public and secret keys.

**Pro tip!** If you are signed into your [Clerk Dashboard](https://dashboard.clerk.com/), your keys should become visible by clicking on the eye icon.

<InjectKeys>

```sh filename=".env.local"
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY={{pub_key}}
CLERK_SECRET_KEY={{secret}}
```

</InjectKeys>

### Wrap your app in `<ClerkProvider />`

The [`<ClerkProvider />`](/docs/components/clerk-provider) component provides active session and user context to Clerk's hooks and other components. For this project, it makes sense to wrap the `<html/>` element with `<ClerkProvider />`. This makes the active session and user context accessible anywhere within the app.

<Tabs items={["App Router version", "Page Router version"]}>
  <Tab>
    
    <Callout>
      The `app/layout.tsx` file might be in your `src` folder if it isn't in your root folder.
    </Callout>

    ```tsx filename="/src/app/layout.tsx"
    import { ClerkProvider } from '@clerk/nextjs'

    export const metadata = {
      title: 'Next.js 13 with Clerk',
    }

    export default function RootLayout({
      children,
    }: {
      children: React.ReactNode
    }) {
      return (
        <ClerkProvider>
          <html lang="en">
            <body>{children}</body>
          </html>
        </ClerkProvider>
      )
    }
    ```

    <Callout type="warning">
      The root layout is a server component. If you plan to use the `<ClerkProvider />` outside the root layout, it will need to be a server component as well.
    </Callout>
  </Tab>
  <Tab>
    ```tsx filename="_app.tsx"
      import { ClerkProvider } from "@clerk/nextjs";
      import type { AppProps } from "next/app";
      function MyApp({ Component, pageProps }: AppProps) {
        return (
          <ClerkProvider {...pageProps}>
            <Component {...pageProps} />
          </ClerkProvider>
        );
      }
      export default MyApp;
      ```
  </Tab>
</Tabs>

### Require authentication to access your app

Now that Clerk is installed and mounted in your application, you can decide which pages are public and which should should require authentication to access. 

Create a `middleware.ts` file. If your application uses the `src/` directory, your `middleware.ts` file should be placed inside the `src/` folder. If you are not using a `src/` directory, place the `middleware.ts` file in your root directory alongside `.env.local`. 

Copy and paste the following code into your `middleware.ts`. With this, your entire application is protected. 

```tsx filename="middleware.ts"
import { authMiddleware } from "@clerk/nextjs";

// This example protects all routes including api/trpc routes
// Please edit this to allow other routes to be public as needed.
// See https://clerk.com/docs/references/nextjs/auth-middleware for more information about configuring your Middleware
export default authMiddleware({});

export const config = {
      matcher: ['/((?!.+\\.[\\w]+$|_next).*)', '/', '/(api|trpc)(.*)'],
};

```

**Try accessing your app now by visiting [`http://localhost:3000`](http://localhost:3000).** The Middleware will redirect you to your Sign Up page. If you want to make other routes public, check out the [authMiddleware reference page](/docs/references/nextjs/auth-middleware). Go ahead and sign up to get access to your application. Your app is now fully protected by Clerk!

### Embed the `<UserButton />`

Clerk offers a set of [prebuilt components](/docs/components/overview) to add functionality to your app with minimal effort. The [`<UserButton />`](/docs/components/user/user-button) allows users to manage their account information and log out, completing the full authentication circle.

You can add it anywhere you want, but next to the logo in your main application page is a good start.

<CodeBlockTabs options={["App Router", "Pages Router"]}>
```tsx filename="app/page.tsx"
import { UserButton } from "@clerk/nextjs";

export default function Home() {
  return (
    <div>
      <UserButton afterSignOutUrl="/"/>
    </div>
  )
}
```

```tsx filename="pages/example.tsx"
import { UserButton } from "@clerk/nextjs";

export default function Example() {
  return (
    <>
			<header>
				<UserButton afterSignOutUrl="/"/>
			</header>
			<div>Your page's content can go here.</div>
    </>
  );
}
```
</CodeBlockTabs>

### Sign up for your application

Now start your Next.js application via `npm run dev`, visit [`localhost:3000`](http://localhost:3000), and sign up to get access to your application.

</Steps>

## You're authenticated!

Congratulations! Your app is now only available to authenticated users! But this is just the first step. 


### Get the finished project

<Tabs items={["App Router version", "Page Router version"]}>
  <Tab>
    [`github.com/clerkinc/clerk-next-app-router-starter`](https://github.com/clerkinc/clerk-next-app-router-starter)
  </Tab>
  <Tab>
    [`github.com/clerkinc/clerk-nextjs-starter`](https://github.com/clerkinc/clerk-nextjs-starter)
  </Tab>
</Tabs>

# Next steps

<div className="container mx-auto my-4">
  <div className="grid grid-cols-1 gap-6 md:grid-cols-2">
    <Cards title="Create custom sign-up and sign-in pages" description="Learn how add custom sign-up and sign-in pages with Clerk components." link="/docs/references/nextjs/custom-signup-signin-pages" cta="Learn More" />

    <Cards title="Read user and session data" description="Learn how to use Clerk's to access the active session and user data in your Next.js application." link="/docs/references/nextjs/read-sessions-data" cta="Learn More" />

    <Cards title="Client Side Helpers" description="Learn more about our client side helpers and how to use them." link="/docs/references/nextjs/overview#client-side-helpers" cta="Learn More" />

    <Cards title="Next.js SDK Reference" description="Learn more about additional Next.js methods." link="/docs/references/nextjs/overview" cta="Learn More" />
  </div>
</div>
