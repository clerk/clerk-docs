---
title: Requiring authentication for route protection | Next.js
description: Learn how to protect the routes in your Next.js application that require authentication.
---

# Requiring authentication for route protection

Whether you're using the App Router, Pages Router, or Middleware, there are several methods you can use to protect routes within your app that require a signed in user to access. This guide will go through a variety of examples of how to do this.

If you want to learn about protecting routes based on [organization](/docs/organizations/overview) roles or permissions, see the [requiring authorization](/docs/references/nextjs/route-protection-requiring-authorization) guide.

## App Router

### Protect a layout or page

You can protect an entire route tree or an individual page by using Clerk helpers. There are two methods that you can use depending on your use case:

- Using [`auth().protect()`](/docs/references/nextjs/auth#protect) if you want to redirect unauthenticated users to the sign in route automatically
- Using [`auth().userId`](/docs/references/nextjs/auth#retrieving-user-id) if you want more control over what your app does based on user authentication status

#### Use `auth().protect()`

The following examples require a user to be signed in to view the content. If the user is not signed in, they will be redirected to the sign-in route.

<CodeBlockTabs type="router" options={["app/dashboard/layout.tsx", "app/subscribe/page.tsx"]}>

```tsx filename="app/dashboard/layout.tsx"
import { auth } from '@clerk/nextjs/server';

export default async function Layout({ children }) {
  // If the user is not signed in they will be redirected to the sign-in route
  // If the user is signed in they can view the content
  auth().protect();

  return <>{children}</>;
}
```


```tsx filename="app/subscribe/page.tsx"
import { auth } from '@clerk/nextjs/server';

export default function Page() {
  if (!auth().userId) {
    // If the user is not signed in they will be redirected to the sign-in route
    // If the user is signed in they can view the route
    return auth().protect();
  }

  return (
    <>
      <h1>Plan Subscription</h1>
      <p>Subscribe to one of our plans, and get access today!</p>
    </>
  );
}
```
</CodeBlockTabs>

#### Use `auth().userId`

If you want to do something other than redirecting the user to the sign-in route, you can use `auth().userId` to check if the user is signed in and then perform the action you want based on the user's authentication status.

<CodeBlockTabs type="router" options={["app/dashboard/layout.tsx", "app/subscribe/page.tsx"]}>

```tsx filename="app/dashboard/layout.tsx"
import { auth } from '@clerk/nextjs/server';
import { SignInButton, SignOutButton } from '@clerk/nextjs';

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  const { userId } = auth();

  if (!userId) {
    return (
      <>
        <header>
          <SignInButton />
        </header>
        <main>{children}</main>
      </>
    );
  }

  return (
    <>
      <header>
        <p>Your userId is {userId}</p>
        <SignOutButton />
      </header>
      <main>{children}</main>
    </>
  );
}
```

```tsx filename="app/subscribe/page.tsx"
import { SignInButton } from '@clerk/nextjs';
import { auth } from '@clerk/nextjs/server';

export default function Page() {
  const { userId } = auth();

  if (!userId) {
    return (
      <div>
        <p>You are not signed in. Please sign in to see this content</p>
        <SignInButton />
      </div>
    );
  }
  return (
    <p>This is a protected page. You can see this because you are signed in.</p>
  );
}
```
</CodeBlockTabs>

### Protect your Route Handlers and Server Actions

You can use protect queries and mutations in your Route Handlers or Server Actions in two ways:

- `auth().protect()` if you want Clerk to automatically return an error
- `auth().userId` if you want to customize the behavior or error message

<CodeBlockTabs type="router" options={["auth().protect()", "auth().userId()"]}>

```tsx filename="/app/api/dashboard/route.ts"
import { auth } from "@clerk/nextjs/server";

export async function GET() {

  // If there is no signed in user, this will return an error
  auth().protect()

  // Add your Route Handler logic here

  return Response.json({ userId })
}
```

```tsx filename="app/api/dashboard/route.ts"
import { auth } from '@clerk/nextjs/server';

export async function GET() {
  const { userId } = auth();

  if (!userId) {
    return Response.json(
      { error: 'Error: No signed in user' },
      { status: 401 },
    );
  }

  // Add your Route Handler logic here

  return Response.json({ userId });
}
```
</CodeBlockTabs>

## Pages Router

### Protect a page

You can protect a page using [`getServerSideProps()`](https://nextjs.org/docs/pages/building-your-application/data-fetching/get-server-side-props) when using Server Side Rendering, or with [`useUser()`](/docs/references/react/use-user) from the client side.

<Tabs type="router" items={["Server Side Rendered", "Client side"]}>
<Tab>
```tsx filename="pages/subscribe.tsx"
import { getAuth, buildClerkProps } from '@clerk/nextjs/server';
import { GetServerSideProps, InferGetServerSidePropsType } from 'next';

export const getServerSideProps: GetServerSideProps = async (ctx) => {
  const { userId } = getAuth(ctx.req);

  if (!userId) {
    return {
      redirect: {
        permanent: false,
        destination: `/sign-in`,
      },
    };
  }

  return { props: { ...buildClerkProps(ctx.req) } };
};

export default function Page(
  props: InferGetServerSidePropsType<typeof getServerSideProps>,
) {
  return (
    <>
      <h1>Plan Subscription</h1>
      <p>Subscribe to one of our plans, and get access today!</p>
    </>
  );
}
```
</Tab>

<Tab>
Note that in the following example, all content is sent to the client. If JavaScript doesn't run, the user can see the content. If you need to protect sensitive content, use the "Server Side Rendered" example or [`clerkMiddleware()`](#protect-your-application-with-middleware) instead.

```tsx filename="pages/subscribe.tsx"
import { useUser } from "@clerk/nextjs";
import { useRouter } from "next/router";

export default function Page() {
  const { isLoaded, user } = useUser();
  const router = useRouter();

  if (!isLoaded) return null

  if (!user?.id) {
    router.push('/sign-in')
  }

  return (
    <>
      <h1>Plan Subscription</h1>
      <p>Subscribe to one of our plans, and get access today!</p>
    </>
  );
}
```
</Tab>
</Tabs>

## Protect your application with Middleware

You can protect your routes using Middleware with `clerkMiddleware()`, which allows you to select the routes you want to protect. See the [reference documentation](/docs/references/nextjs/clerk-middleware) for more information.
