import { Tab, Tabs } from "nextra-theme-docs";
import { Tables } from "@/components/Table";
import { Images } from "@/components/Images";
import { CodeBlockTabs } from "@/components/CodeBlockTabs";

# `SignIn`

The `SignIn` object holds all the state of the current sign in and provides helper methods to navigate and complete the sign in process.

There are two important steps in the sign in flow.

1. Users *must* complete a first factor verification. This can be something like providing a password, an email magic link, a one-time code (OTP), a web3 wallet public address or providing proof of their identity through an external social account (SSO/OAuth).
2. After that, users *might need to* go through a second verification process. This is the second factor (2FA).

The `SignIn` object's properties can be split into logical groups, with each group providing information on different aspects of the sign in flow. These groups can be:

- Information about the current sign in status in general and which authentication identifiers, authentication methods and verifications are supported.
- Information about the user and the provided authentication identifier value (email address, phone number or username).Information about each verification, either the first factor (logging in) or the second factor (2FA).

## Attributes

| Name                      | Type                   | Description                                                  |
| ------------------------- | ---------------------- | ------------------------------------------------------------ |
| status                    | string                 | The current status of the sign-in. It can take the following values:**needs_identifier**: The authentication identifier hasn't been provided.**needs_first_factor**: First factor verification for the provided identifier needs to be prepared and verified.**needs_second_factor**: Second factor verification (2FA) for the provided identifier needs to be prepared and verified.**complete**: The sign-in is complete and the user is authenticated.**abandoned**: The sign-in has been inactive for a long period of time, thus it's considered as abandoned and need to start over. |
| supportedIdentifiers      | string[]               | Array of all the authentication identifiers that are supported for this sign in. Examples of this could be **email_address, phone_number, web3_wallet** or **username.** |
| identifier                | string \| null         | The authentication identifier value for the current sign-in. |
| supportedExternalAccounts | string[]               | Array of all the external accounts that can be used in this sign in, e.g. **oauth_google**, **oauth_facebook**, etc. |
| supportedFirstFactors     | SignInFactor[]         | Array of the first factors that are supported in the current sign-in. Each factor contains information about the verification strategy that can be used, e.g. **email_code** for email addresses, **phone_code** for phone numbers, etc., as well as the identifier that the factor refers to. |
| supportedSecondFactors    | SignInFactor[] \| null | Array of the second factors that are supported in the current sign-in. Each factor contains information about the verification strategy that can be used, e.g. **email_code** for email addresses, **phone_code** for phone numbers, **totp** for TOTPs, etc., as well as the identifier that the factor refers to. Please note that this property is populated only when the first factor is verified. |
| firstFactorVerification   | VerificationResource   | The state of the verification process for the selected first factor. Please note that this property contains an empty verification object initially, since there is no first factor selected. You need to call the `SignIn.prepareFirstFactor` method in order to start the verification process. |
| secondFactorVerification  | VerificationResource   | The state of the verification process for the selected second factor. Similar to **firstFactorVerification**, this property contains an empty verification object initially, since there is no second factor selected. For the `phone_code` strategy, you need to call the `SignIn.prepareSecondFactor` method in order to start the verification process. For the `totp` strategy you can directly attempt. |
| userData                  | UserDate \| null       | An object containing information about the user of the current sign in. This property is populated only once an identifier is given to the `SignIn` object. |
| createdSessionId          | string \| null         | The identifier of the session that was created upon completion of the current sign-in. The value of this property is **null** if the sign-in status is not **complete**. |

## Methods

### `create()`

```typescript
function create(params: SignInCreateParams): Promise<SignInResource>;
```

Use this method to kick-off the sign in flow. It creates a **SignIn** object and stores the sign in lifecycle state.

Depending on the use-case and the `params` you pass to the `create` method, it can either complete the sign in process in one go, or simply collect part of the necessary data for completing authentication at a later stage.

**Parameters**

| Name   | Description                                                  |
| ------ | ------------------------------------------------------------ |
| params | *SignInCreateParams* Depending on the keys and values passed here, the create method's behavior changes. |

**Returns**

| Type                    | Description                                                  |
| ----------------------- | ------------------------------------------------------------ |
| {"Promise<SignInResource>"} | This method returns a `Promise` which resolves with a `SignIn` object. Check the `status` attribute to see if the `SignIn` has been completed or a hint on what needs to happen next. |

### `createMagicLinkFlow()`

```typescript
function createMagicLinkFlow(): CreateMagicLinkFlowParams<SignInStartMagicLinkFlowParams, SignInResource>;
```

Sets up a sign in with magic link flow. Calling `createMagicLinkFlow()` will return two functions. The first function is async and starts the magic link flow, preparing a magic link verification. It sends the magic link email and starts polling for verification results. The signature is `startMagicLinkFlow({ redirectUrl: string, emailAddressId: string }) => Promise<SignInResource>`.

The second function can be used to stop polling at any time, allowing for full control of the flow and cleanup. The signature is `cancelMagicLinkFlow() => void`.

**Returns**

| Type                                                         | Description                                                  |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| {"CreateMagicLinkFlowReturn<SignInStartMagicLinkFlowParams, SignInResource>"} | This method returns two functions. One to start the magic link flow and the other to cancel waiting for the results. |

### `authenticateWithRedirect()`

```
authenticateWithRedirect(params: AuthenticateWithRedirectParams) => Promise<void>
```

Signs in users via OAuth. This is commonly known as Single Sign On (SSO), where an external account is used for verifying the user's identity.

**Parameters**

| Type   | Description                                                  |
| ------ | ------------------------------------------------------------ |
| params | An object that specifies the verification strategy (one of the supported OAuth providers), the callback URL the OAuth provider should redirect to, as well as the URL that the user should be redirected to upon successful sign in. |

**Returns**

| Type          | Description                                                  |
| ------------- | ------------------------------------------------------------ |
| {"Promise<void>"} | This method returns a `Promise` which doesn't resolve to any value. |

### `authenticateWithMetamask()`

```
authenticateWithMetamask() => Promise<SignInResource>
```

Starts a sign in flow that uses the Metamask browser extension to authenticate the user using their public wallet address.

**Parameters**

This methods does not accept any parameters.

**Returns**

| Type                    | Description                                                  |
| ----------------------- | ------------------------------------------------------------ |
| {"Promise<SignInResource>"} | This method returns a `Promise` which resolves to the current `SignInResource`. |