---
title: Proxying the Clerk Frontend API
description: Learn how to proxy the Clerk Frontend API through your domain.
---

# Proxying the Clerk Frontend API

Clerk supports two configuration methods for connecting to the Clerk Frontend API: CNAME and Proxy.

The recommended way to connect to the Clerk Frontend API is to [set up CNAME records and use DNS](/docs/deployments/overview). However, if you're unable to use this approach, or would like more control over your integration with Clerk, you can use a proxy.

When using a proxy, all requests to the Frontend API will be made through your domain. This allows you to use your own SSL certificate, and gives you more control over how you configure your application.

## How to use proxying

<Steps>
### Create your application and install Clerk

To get started, you need to create an application from the [Clerk Dashboard](https://dashboard.clerk.com/). Once you create an instance via the Clerk Dashboard, you will be prompted to choose a domain. For the purposes of this guide, the domain will be `app.dev`.

<Callout type="info">
  For more information on creating a Clerk application, check out our [Set up your application guide](/docs/quickstarts/setup-clerk).
</Callout>

### Configure your proxy server

For this example, `/__clerk` is used as the path for the proxy. Your proxy server must be on the same domain as your application.

You can choose any path you'd like, but it must be unique and not conflict with any other routes in your application.

#### Requirements

Requests to `https://app.dev/__clerk/*` must be forwarded to `https://frontend-api.clerk.dev/*` with the body and all headers intact.

Three additional headers must be set

- `Clerk-Proxy-Url`: Needs to have the full proxy URL.
- `Clerk-Secret-Key`: The secret key for your Clerk instance.
- `X-Forwarded-For`: The IP address of the original client making the request.

#### Example configuration

<Tabs items={["Nginx", "Cloudflare Workers"]}>
  <Tab>
    ```conf filename="nginx.conf"
    http {
      # ...
      server {
        # ...
        location /__clerk/ {
          rewrite ^/__clerk/(.*)$ /$1 break;
          proxy_pass https://frontend-api.clerk.dev;
          proxy_set_header Clerk-Proxy-Url https://app.dev/__clerk;
          proxy_set_header Clerk-Secret-Key sk_live_***;
          proxy_set_header X-Forwarded-For $remote_addr;
          proxy_redirect off;
        }
      }
    }
    ```
  </Tab>

  <Tab>
    <CodeBlockTabs options={["Handler", "Wrangler Config", "Environment", "Types"]}>
      ```ts filename="src/index.ts"
        export default {
          async fetch(req: Request, env: Env, _ctx: ExecutionContext): Promise<Response> {
            const url = req.url.replace(env.CLERK_PROXY_URL, env.CLERK_FAPI)
            const proxyReq = new Request(req, {
              redirect: 'manual',
            });

            proxyReq.headers.set('Clerk-Proxy-Url', env.CLERK_PROXY_URL);
            proxyReq.headers.set('Clerk-Secret-Key', env.CLERK_SECRET_KEY);
            proxyReq.headers.set('X-Forwarded-For', req.headers.get('CF-Connecting-IP') || '');

            return fetch(url, proxyReq);
          },
        };
      ```

      ```toml filename="wrangler.toml"
        name = "cloudflare-proxy"
        main = "src/index.ts"
        compatibility_date = "2023-10-02"

        [vars]
        CLERK_FAPI="https://frontend-api.clerk.dev"
      ```

      ```env filename=".dev.vars"
        # Do not commit this file to source control
        CLERK_PROXY_URL="https://app.dev/__clerk"
        CLERK_SECRET_KEY="sk_live_xxxxx"
      ```

      ```ts filename="worker-configuration.d.ts"
        interface Env {
          CLERK_FAPI: string;
          CLERK_PROXY_URL: string;
          CLERK_SECRET_KEY: string;
        }
      ```
    </CodeBlockTabs>
  </Tab>
</Tabs>

<Callout type="info">
  Every proxy configuration will be different and we're here to help. Please [reach out](https://clerk.com/support) if there's a specific use-case you're looking to solve.
</Callout>

### Enable proxying

In order to enable proxying, you need to set a proxy URL for your Clerk instance's domain. This can be done through the Clerk Dashboard or through the Backend API.

<Callout type="info">
  To avoid downtime, your proxy must be set up according to the above configuration before it can be enabled for your instance.
  Make sure your proxy forwards requests to the Clerk Frontend API correctly and includes the required headers.
</Callout>

<Tabs items={["Dashboard", "Backend API"]}>
  <Tab>
    1. In the Clerk Dashboard, go to the **[Domains](https://dashboard.clerk.com/last-active?path=domains)** page.
    2. Navigate to the **Frontend API** section.
    3. Select the **Advanced** drop down.
    4. In the **Proxy URL** field, enter your proxy URL. The proxy URL must be a valid URL and resolve correctly.
  </Tab>

  <Tab>
    The request below will update the domain to use the proxy URL `https://app.dev/__clerk`. In doing so, it will trigger checks to validate the proxy URL.

    ```bash
    curl -X PATCH https://api.clerk.com/v1/domains/{{DOMAIN ID}} \
        -H "Authorization: Bearer {{SECRET KEY}}" \
        -H "Content-Type: application/json" \
        -d '{"proxy_url": "https://app.dev/__clerk"}}'
    ```
  </Tab>
</Tabs>

### Configure your proxy setup

You can configure your proxy setup by either:
- Setting environment variables
- Using properties in your application

#### Environment variables

To configure your proxy setup using environment variables, your `.env.local` file should look like this:

<InjectKeys>
  <Tabs type="framework" items={["Next.js", "Remix", "JavaScript"]}>
    <Tab>
    ```env filename=".env.local"
    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY={{pub_key}}
    CLERK_SECRET_KEY={{secret}}

    NEXT_PUBLIC_CLERK_PROXY_URL=https://app.dev/__clerk
    ```
    </Tab>

    <Tab>
    ```env filename=".env.local"
    CLERK_PUBLISHABLE_KEY={{pub_key}}
    CLERK_SECRET_KEY={{secret}}

    CLERK_PROXY_URL=https://app.dev/__clerk
    ```
    </Tab>

    <Tab>
    You will only need to set environment variables in your JavaScript application if you are using a bundler (the `NPM module` method for ClerkJS installation). If you are using the `<script>` method, configure your proxy setup using [properties in your application](#properties-in-your-application) instead.

    ```env filename=".env.local"
    CLERK_PUBLISHABLE_KEY={{pub_key}}
    CLERK_SECRET_KEY={{secret}}

    CLERK_PROXY_URL=https://app.dev/__clerk
    ```
    </Tab>
  </Tabs>
</InjectKeys>

#### Properties in your application

<Tabs type="framework" items={["Next.js", "Remix", "JavaScript"]}>
  <Tab>
    To configure your proxy setup using properties in your Next.js application, set the `proxyUrl` property on the [`<ClerkProvider>`](https://clerk.com/docs/components/clerk-provider) component.

    <CodeBlockTabs type="router" options={["App Router", "Pages Router"]}>
    ```tsx filename="app/layout.tsx" {9}
    import { ClerkProvider } from '@clerk/nextjs';

    export default function RootLayout({
      children,
    }: {
      children: React.ReactNode
    }) {
      return (
        <ClerkProvider proxyUrl='https://app.dev/__clerk'>
          <html lang="en">
            <body>{children}</body>
          </html>
        </ClerkProvider>
      )
    }
    ```

    ```tsx filename="_app.tsx" {6}
    import { ClerkProvider } from "@clerk/nextjs";
    import type { AppProps } from "next/app";

    function MyApp({ Component, pageProps }: AppProps) {
      return (
        <ClerkProvider proxyUrl='https://app.dev/__clerk' {...pageProps}>
          <Component {...pageProps} />
        </ClerkProvider>
      );
    }
    export default MyApp;
    ```
    </CodeBlockTabs>
  </Tab>

  <Tab>
    To configure your proxy setup using properties in your Remix application, set the `proxyUrl` property on the [`ClerkApp`](/docs/references/remix/clerk-app) wrapper.

    ```tsx filename="root.tsx"
      export const loader = (args) => {
        return rootAuthLoader(
          args,
          ({ request }) => {
            const { userId, sessionId, getToken } = request.auth;
            return json({
                message: `Hello from the root loader :)`,
                ENV: getBrowserEnvironment(),
            });
          },
          {
            loadUser: true,
            proxyUrl: 'https://app.dev/__clerk'
          } as const
        );
      };

      export default ClerkApp(App, {
        proxyUrl: 'https://app.dev/__clerk'
      });
    ```
  </Tab>

  <Tab>
    To configure your proxy setup using properties in your JavaScript application, pass the `proxyUrl` option to the [`load()`](/docs/references/javascript/clerk/clerk#load) method.

    <InjectKeys>
      <CodeBlockTabs type="npm-script" options={["NPM module", "<script>"]}>
        ```js filename="main.js"
          import { Clerk } from '@clerk/clerk-js';

          // Initialize Clerk with your Clerk publishable key
          const clerk = new Clerk('{{pub_key}}');

          await clerk.load({
            proxyUrl: 'https://app.dev/__clerk',
          });
        ```

        ```html filename="index.html"
          <!-- Initialize Clerk with your
          Clerk Publishable key and Frontend API URL -->
          <script
            async
            crossorigin="anonymous"
            data-clerk-publishable-key="{{pub_key}}"
            src="https://{{fapi_url}}/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
            type="text/javascript"
          ></script>

          <script>
            window.addEventListener("load", async function () {
              await Clerk.load({
                proxyUrl: 'https://app.dev/__clerk',
              });
            });
          </script>
        ```
      </CodeBlockTabs>
    </InjectKeys>
  </Tab>
</Tabs>

### Ready to go ðŸŽ‰
Your application should now be able to access Clerk's Frontend API from your proxy!
</Steps>

If you have any questions about proxying, or you're having any trouble setting this up, please contact support@clerk.com.
