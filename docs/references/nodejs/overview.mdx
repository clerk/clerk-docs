---
title: Clerk Node.js SDK
description: Learn how to integrate Node.js into your Clerk application.
---

# Clerk Node.js SDK

## Set up Clerk Node.js

<Steps>

### Create a Clerk application 

You need to create a Clerk application in your Clerk Dashboard before you can set up Clerk Node.js. For more information, check out our [Set up your application](/docs/quickstarts/setup-clerk) guide.

### Install `@clerk/clerk-sdk-node`

Once a Clerk application has been created, you can install and then start using Clerk Node.js in your application. An ES module for the Clerk Node SDK is available under the [`@clerk/clerk-sdk-node`](https://www.npmjs.com/package/@clerk/clerk-sdk-node) npm package.

<CodeBlockTabs type="installer" options={["npm", "yarn", "pnpm"]}>
```sh filename="terminal"
npm install @clerk/clerk-sdk-node
```

```sh filename="terminal"
yarn add @clerk/clerk-sdk-node
```

```sh filename="terminal"
pnpm add @clerk/clerk-sdk-node
```
</CodeBlockTabs>

### Set environment keys

Below is an example of an `.env.local` file. If you are signed into your Clerk Dashboard, your secret key should become visible by clicking on the eye icon.

<InjectKeys>

```env filename=".env.local"
CLERK_SECRET_KEY={{secret}}
```

</InjectKeys>

</Steps>

## Resources

All resource operations are mounted as sub-APIs on the `clerkClient` object. You can find the full list of available operations in the [Clerk Backend SDK](/docs/references/backend/overview) documentation.

### Instantiate a default Clerk client instance

If you are comfortable with setting the `CLERK_SECRET_KEY` environment variable and being finished, the default instance created by the SDK will suffice for your needs.

<Tabs items={["ESM", "CJS"]}>
  <Tab>
  ```js
  import { clerkClient } from '@clerk/clerk-sdk-node';

  const userList = await clerkClient.users.getUserList();
  ```

  Or if you are interested only in a certain resource:

  ```js
  import { sessions } from '@clerk/clerk-sdk-node';

  const sessionList = await sessions.getSessionList();
  ```
  </Tab>

  <Tab>
  ```js
  const pkg = require('@clerk/clerk-sdk-node');
  const clerkClient = pkg.default;

  clerkClient.sessions
    .getSessionList()
    .then((sessions) => console.log(sessions))
    .catch((error) => console.error(error));
  ```

  Or if you prefer a resource sub-api directly:

  ```js
  const pkg = require('@clerk/clerk-sdk-node');
  const { clients } = pkg;

  clients
    .getClient(clientId)
    .then((client) => console.log(client))
    .catch((error) => console.error(error));
  ```
  </Tab>
</Tabs>

### Instantiate a custom Clerk client instance

If you would like to customize the behavior of the SDK, you can instantiate a `clerkClient` instance yourself by calling `createClerkClient` and passing in [options](#customizing-resources).

The example below shows how to use `createClerkClient` to create a `clerkClient` instance and pass a Clerk secret key *instead of* setting a `CLERK_SECRET_KEY` environment variable.

<InjectKeys>

<CodeBlockTabs options={["ESM", "CJS"]}>
```js
import { createClerkClient } from '@clerk/clerk-sdk-node';

const clerkClient = createClerkClient({ secretKey: '{{secret}}' });

const clientList = await clerkClient.clients.getClientList();
```

```js
const Clerk = require('@clerk/clerk-sdk-node/cjs/instance').default;

const clerkClient = Clerk({ secretKey: '{{secret}}' });

clerkClient.sessions
  .getSessionList()
  .then((sessions) => console.log(sessions))
  .catch((error) => console.error(error));
```
</CodeBlockTabs>

</InjectKeys>

### Customizing resources

The following options are available for you to customize the behaviour of the `clerkClient` object.

<Callout type="info">
  Most options can also be set as environment variables so that you don't need to pass anything to the constructor or set it via the available setters.
</Callout>

| Option | Description | Default | Environment variable |
| --- | --- | --- | --- |
| `secretKey` | Server key for `api.clerk.com`. Can be found in your Clerk Dashboard on the **[API Keys](https://dashboard.clerk.com/last-active?path=api-keys)** page. | none | `CLERK_SECRET_KEY` |
| `apiVersion` | API version to use | `v4` | `CLERK_API_VERSION` |
| `apiUrl` | For debugging | `https://api.clerk.com` | `CLERK_API_URL` |
| `httpOptions` | HTTP client options | `{}` | N/A |

{/* TODO: I think more of a description and example can be added for httpOptions. Also, we need to add information for audience, proxyUrl, jwtKey, publishableKey, domain, isSallite, telemetry */}

For every option, the resolution is as follows, in order of descending precedence:

- option passed
- environment variable (if applicable)
- default

This means that if you pass an option to the constructor, it will always take precedence over an environment variable.

Another available environment variable is `CLERK_LOGGING`. You can set its value to `true` to enable additional logging that may be of use when debugging an issue.

## Multi-session applications

If Clerk is running in multi-session mode, it's important to ensure your frontend sends the Session ID that is making the request.

Our middleware will look for a query string parameter named `_clerk_session_id`. If this parameter is not found, the middleware will instead choose the last active session, which may be subject to race conditions and should not be relied on for authenticating actions.

## Connect/Express middlewares

The Clerk Node SDK offers two [middlewares](/docs/backend-requests/handling/nodejs) to authenticate your backend endpoints.

## Manual authentication

### Authenticate a particular session

```js
import { sessions } from '@clerk/clerk-sdk-node';
import Cookies from 'cookies';

// Retrieve the particular session ID from a
// query string parameter
const sessionId = req.query._clerk_session_id;

// Note: Clerk stores the clientToken in a cookie 
// named "__session" for Firebase compatibility
const cookies = new Cookies(req, res);
const clientToken = cookies.get('__session');  

const session = await sessions.verifySession(sessionId, clientToken);
```

### Authenticate the last active session

Using the last active session is appropriate when determining the user after a navigation.

```js
import { clients, sessions } from '@clerk/clerk-sdk-node';
import Cookies from 'cookies';

// Note: Clerk stores the clientToken in a cookie 
// named "__session" for Firebase compatibility
const cookies = new Cookies(req, res);
const clientToken = cookies.get('__session');  

const client = await clients.verifyClient(clientToken);
const sessionId = client.lastActiveSessionId;

const session = await sessions.verifySession(sessionId, clientToken);
```
