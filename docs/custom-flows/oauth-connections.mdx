---
title: Build a custom flow for authenticating with OAuth connections
description: Learn how to use the Clerk API to build a custom sign-up and sign-in flow that supports OAuth connections.
---

<Include src="_partials/custom-flows-callout" />

## Before you start

You must configure your application instance through the Clerk Dashboard for the social connection(s) that you want to use. Visit [the appropriate guide for your platform](/docs/authentication/social-connections/overview) to learn how to configure your instance.

## Create the sign-up and sign-in flow

<Tabs items={["Next.js", "Expo", "iOS (beta)"]}>
  <Tab>
    <Include src="_partials/custom-flows/sso-connections" />

    <CodeBlockTabs options={["Sign in page", "SSO callback page"]}>
      ```tsx {{ filename: 'app/sign-in/page.tsx' }}
      'use client'

      import * as React from 'react'
      import { OAuthStrategy } from '@clerk/types'
      import { useSignIn } from '@clerk/nextjs'

      export default function OauthSignIn() {
        const { signIn } = useSignIn()

        if (!signIn) return null

        const signInWith = (strategy: OAuthStrategy) => {
          return signIn
            .authenticateWithRedirect({
              strategy,
              redirectUrl: '/sign-up/sso-callback',
              redirectUrlComplete: '/',
            })
            .then((res) => {
              console.log(res)
            })
            .catch((err: any) => {
              // See https://clerk.com/docs/custom-flows/error-handling
              // for more info on error handling
              console.log(err.errors)
              console.error(err, null, 2)
            })
        }

        // Render a button for each supported OAuth provider
        // you want to add to your app. This example uses only Google.
        return (
          <div>
            <button onClick={() => signInWith('oauth_google')}>Sign in with Google</button>
          </div>
        )
      }
      ```

      ```tsx {{ filename: 'app/sign-up/sso-callback.tsx' }}
      import { AuthenticateWithRedirectCallback } from '@clerk/nextjs'

      export default function SSOCallback() {
        // Handle the redirect flow by calling the Clerk.handleRedirectCallback() method
        // or rendering the prebuilt <AuthenticateWithRedirectCallback/> component.
        // This is the final step in the custom OAuth flow.
        return <AuthenticateWithRedirectCallback />
      }
      ```
    </CodeBlockTabs>
  </Tab>

  <Tab>
    <Include src="_partials/expo/oauth-custom-flow" />
  </Tab>

  <Tab>
    ```swift {{ filename: 'OAuthView.swift', collapsible: true }}
    import SwiftUI
    import ClerkSDK

    struct OAuthView: View {
      var body: some View {
        // Render a button for each supported OAuth provider
        // you want to add to your app. This example uses only Google.
        Button("Sign In with Google") {
          Task { await signInWithOAuth(provider: .google) }
        }
      }
    }

    extension OAuthView {

      func signInWithOAuth(provider: OAuthProvider) async {
        do {
          // Start the sign-in process using the selected OAuth provider.
          let signIn = try await SignIn.create(strategy: .oauth(provider))

          // Start the OAuth process
          let externalAuthResult = try await signIn.authenticateWithRedirect()

          // It is common for users who are authenticating with OAuth to use
          // a sign-in button when they mean to sign-up, and vice versa.
          // Clerk will handle this transfer for you if possible.
          // Therefore, an ExternalAuthResult can contain either a SignIn or SignUp.

          // Check if the result of the OAuth was a sign in
          if let signIn = externalAuthResult?.signIn {
            switch signIn.status {
            case .complete:
              // If sign-in process is complete, navigate the user as needed.
              dump(Clerk.shared.session)
            default:
              // If the status is not complete, check why. User may need to
              // complete further steps.
              dump(signIn.status)
            }
          }

          // Check if the result of the OAuth was a sign up
          if let signUp = externalAuthResult?.signUp {
            switch signUp.status {
            case .complete:
              // If sign-up process is complete, navigate the user as needed.
              dump(Clerk.shared.session)
            default:
              // If the status is not complete, check why. User may need to
              // complete further steps.
              dump(signUp.status)
            }
          }
        } catch {
          // See https://clerk.com/docs/custom-flows/error-handling
          // for more info on error handling.
          dump(error)
        }
      }
    }
    ```
  </Tab>
</Tabs>
