The [`has()`](/docs/references/backend/types/auth-object#has) helper returns `false` if the user does not have the correct access control. If they aren't authorized, you can choose how your app responds. It can be used to perform authorization checks in pages, route handlers, and Server Actions (Next.js only) to protect them from unauthorized access.

<Include src="_partials/has-warning" />

<Tabs items={["Protect a page", "Protect a route handler", "Protect a Server Action"]}>
  <Tab>
    The following example demonstrates how to perform authorization checks in a page in order to protect the content from unauthorized access. It uses `has()` to check if the user has the `org:team_settings:manage` permission. If they aren't authorized, `null` is returned and the page isn't rendered.

    This example is written for Next.js App Router, but can be adapted to other frameworks by using [the appropriate method for accessing the `Auth` object](/docs/references/nextjs/auth#how-to-access-the-auth-object).

    ```tsx {{ filename: 'app/page.tsx' }}
    import { auth } from '@clerk/nextjs/server'

    export default async function Page() {
      // Use `auth()` to access the `has()` helper
      // For other frameworks, use the appropriate method for accessing the `Auth` object
      const { has } = await auth()

      // Check if the user is authorized
      const canManage = has({ permission: 'org:team_settings:manage' })

      // If has() returns false, the user does not have the correct permissions
      // You can choose how your app responds. This example returns null.
      if (!canManage) return null

      return <h1>Team Settings</h1>
    }
    ```
  </Tab>

  <Tab>
    The following example demonstrates how to perform authorization checks in a route handler in order to protect it from unauthorized access. It

    - uses the `userId` returned from the [`Auth` object](/docs/references/backend/types/auth-object) to check if the user is signed in. If the user is not **authenticated**, the Route Handler will return a `401` error.
    - uses `has()` to check if the user has the correct permission. If the user is not **authorized**, `has()` will return false, causing the Route Handler to return a `403` error.

    This example is written for Next.js App Router, but can be adapted to other frameworks by using the appropriate method for accessing the [`Auth` object](/docs/references/backend/types/auth-object).

    ```tsx {{ filename: 'app/api/get-teams/route.tsx' }}
    import { auth } from '@clerk/nextjs/server'

    export const GET = async () => {
      // Use `auth()` to access the `has()` helper and the `userId`
      // For other frameworks, use the appropriate method for accessing the `Auth` object
      const { userId, has } = await auth()

      // Check if the user is authenticated
      if (!userId) {
        return Response.json({ error: 'User is not signed in' }, { status: 401 })
      }

      // Check if the user is authorized
      const canRead = has({ permission: 'org:team_settings:read' })

      // If has() returns false, the user does not have the correct permissions
      // You can choose how your app responds. This example returns a 403 error.
      if (!canRead)
        return Response.json({ error: 'User does not have the correct permissions' }, { status: 403 })

      // If the user is both authenticated and authorized, move forward with your logic
      return users.getTeams(userId)
    }
    ```
  </Tab>

  <Tab>
    The following example demonstrates how to perform authorization checks in a Server Action in order to protect the action from unauthorized access. It

    - uses the `userId` returned from the [`Auth` object](/docs/references/backend/types/auth-object) to check if the user is signed in. If the user is not **authenticated**, the Server Action will return a `401` error.
    - uses `has()` to check if the user has the correct permission. If the user is not **authorized**, `has()` will return false, causing the Server Action to return a `403` error.

    ```tsx {{ filename: 'app/components/ExampleServerComponent.tsx' }}
    import { auth } from '@clerk/nextjs/server'

    export default async function ExampleServerComponent() {
      async function myServerAction(formData: FormData) {
        'use server'
        // Use `auth()` to access the `has()` helper and the `userId`
        const { has, userId } = await auth()

        // Check if the user is authenticated
        if (!userId) {
          return Response.json({ error: 'User is not signed in' }, { status: 401 })
        }

        // Check if the user is authorized
        const canManage = has({ permission: 'org:team_settings:manage' })

        // If has() returns false, the user does not have the correct permissions
        // You can choose how your app responds. This example returns a 403 error.
        if (!canManage)
          return Response.json({ error: 'User does not have the correct permissions' }, { status: 403 })

        // If the user is both authenticated and authorized, move forward with your logic
        return users.getTeams(userId)
      }

      return (
        <form action={myServerAction}>
          {/* Add UI for managing team settings */}
          <button type="submit">Submit</button>
        </form>
      )
    }
    ```
  </Tab>
</Tabs>
