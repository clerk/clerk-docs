---
title: '`updateUserMetadata()`'
description: Use Clerk's JS Backend SDK to update the metadata associated with the specified user.
sdk: js-backend
---

{/* clerk/javascript file: https://github.com/clerk/javascript/blob/main/packages/backend/src/api/endpoints/UserApi.ts#L171 */}

Updates the metadata associated with the specified user by merging existing values with the provided parameters.

A "deep" merge will be performed - "deep" means that any nested JSON objects will be merged as well. You can remove metadata keys at any level by setting their value to `null`.

Returns a [`User`](/docs/reference/backend/types/backend-user) object.

```ts
function updateUserMetadata(userId: string, params: UpdateUserMetadataParams): Promise<User>
```

## `UpdateUserMetadataParams`

<Properties>
  - `userId`
  - `string`

  The ID of the user to update.

  ---

  - `publicMetadata?`
  - [`UserPublicMetadata`](/docs/reference/javascript/types/metadata#user-public-metadata)

  Metadata that can be read from the Frontend API and [Backend API](/docs/reference/backend-api){{ target: '_blank' }} and can be set only from the Backend API.

  ---

  - `privateMetadata?`
  - [`UserPrivateMetadata`](/docs/reference/javascript/types/metadata#user-private-metadata)

  Metadata that can be read and set only from the [Backend API](/docs/reference/backend-api){{ target: '_blank' }}.
</Properties>

## Usage

<Include src="_partials/backend/usage" />

```tsx
const userId = 'user_123'

const response = await clerkClient.users.updateUserMetadata(userId, {
  publicMetadata: {
    example: 'metadata',
  },
})
```

## Example

This example updates the user's public metadata to include a birthday, but you can update the public, private, or unsafe metadata to include any information you want.

<Tabs items={["Next.js", "Astro", "Express", "React Router", "Ruby", "Tanstack React Start"]}>
  <Tab>
    ```ts {{ filename: 'app/api/example/route.ts' }}
    import { auth, clerkClient } from '@clerk/nextjs/server'
    import { NextResponse } from 'next/server'

    export async function GET() {
      const { userId } = await auth()
      const client = await clerkClient()

      await client.users.updateUserMetadata(userId, {
        publicMetadata: {
          birthday: '1990-01-01',
        },
      })

      return NextResponse.json({ success: true })
    }
    ```
  </Tab>

  <Tab>
    ```tsx {{ filename: 'src/api/example.ts' }}
    import type { APIRoute } from 'astro'
    import { clerkClient } from '@clerk/astro/server'

    export const GET: APIRoute = async (context) => {
      const { userId } = context.locals.auth()

      await clerkClient(context).users.updateUserMetadata(userId, {
        publicMetadata: {
          birthday: '1990-01-01',
        },
      })

      return new Response(JSON.stringify({ success: true }), { status: 200 })
    }
    ```
  </Tab>

  <Tab>
    ```ts {{ filename: 'public.ts' }}
    import { getAuth, clerkClient } from '@clerk/express'

    app.post('/updateBirthday', async (req, res) => {
      const { userId } = getAuth(req)

      await clerkClient.users.updateUserMetadata(userId, {
        publicMetadata: {
          birthday: '1990-01-01',
        },
      })
      res.status(200).json({ success: true })
    })
    ```
  </Tab>

  <Tab>
    ```tsx {{ filename: 'app/routes/example.tsx' }}
    import { clerkClient, getAuth } from '@clerk/react-router/server'
    import type { Route } from './+types/example'

    export async function loader(args: Route.LoaderArgs) {
      const { userId } = await getAuth(args)

      await clerkClient.users.updateUserMetadata(userId, {
        publicMetadata: {
          birthday: '1990-01-01',
        },
      })

      return { success: true }
    }
    ```
  </Tab>

  <Tab>
    ```ruby {{ filename: 'public.rb' }}
    # ruby json example with a private metadata and stripe id
    require 'clerk'
    require 'json'

    birthday = {
      "birthday": "1990-01-01",
    }

    clerk = Clerk::SDK.new(api_key: "your_clerk_secret_key")
    clerk.users.updateMetadata("user_xyz", public_metadata: birthday)
    ```
  </Tab>

  <Tab>
    ```tsx {{ filename: 'app/routes/api/example.tsx' }}
    import { json } from '@tanstack/react-start'
    import { createFileRoute } from '@tanstack/react-router'
    import { auth, clerkClient } from '@clerk/tanstack-react-start/server'

    export const ServerRoute = createFileRoute('/api/example')({
      server: {
        handlers: {
          GET: async () => {
            const { userId } = await auth()

            await clerkClient().users.updateUserMetadata(userId, {
              publicMetadata: {
                birthday: '1990-01-01',
              },
            })

            return json({ success: true })
          },
        },
      },
    })
    ```
  </Tab>
</Tabs>

## Backend API (BAPI) endpoint

This method in the SDK is a wrapper around the BAPI endpoint `PATCH/users/{user_id}/metadata`. See the [BAPI reference](/docs/reference/backend-api/tag/users/patch/users/\{user_id}/metadata){{ target: '_blank' }} for more information.

Here's an example of making a request directly to the endpoint using cURL.

```bash {{ filename: 'curl.sh' }}
curl -XPATCH -H 'Authorization: Bearer CLERK_SECRET_KEY' -H "Content-type: application/json" -d '{
  "public_metadata": {
    "birthday": "1990-01-01"
  }
}' 'https://api.clerk.com/v1/users/{user_id}/metadata'
```
