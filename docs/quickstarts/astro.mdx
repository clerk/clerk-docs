---
title: Astro Quickstart
description: Add authentication and user management to your Astro app with Clerk.
---

<TutorialHero
  framework="astro"
  beforeYouStart={[
    {
      title: "Set up a Clerk application",
      link: "/docs/quickstarts/setup-clerk",
      icon: "clerk",
    },
    {
      title: "Create an Astro application",
      link: "https://docs.astro.build/en/install-and-setup",
      icon: "astro",
    },
  ]}
  exampleRepo={[
    {
      title: "Astro Quickstart Repo",
      link: "https://github.com/clerk/clerk-astro-quickstart"
    }
  ]}
>
  - Install `@clerk/astro`
  - Set your Clerk API keys
  - Add `clerkMiddleware()`
  - Create a header with Clerk components for users to sign in and out
</TutorialHero>

<Steps>
  ### Install `@clerk/astro`

  Clerk's [Astro SDK](/docs/references/astro/overview) provides a set of components, hooks, and stores that make it easy to build authentication and user management features in your Astro app.

  Add the SDK to your project by running the following command:

  <CodeBlockTabs options={["npm", "yarn", "pnpm"]}>
    ```bash {{ filename: 'terminal' }}
    npm install @clerk/astro
    ```

    ```bash {{ filename: 'terminal' }}
    yarn add @clerk/astro
    ```

    ```bash {{ filename: 'terminal' }}
    pnpm add @clerk/astro
    ```
  </CodeBlockTabs>

  ### Set your Clerk API keys

  <SignedIn>
    Add the following keys to your `.env.local` file. These keys can always be retrieved from the [**API Keys**](https://dashboard.clerk.com/last-active?path=api-keys) page of your Clerk Dashboard.
  </SignedIn>

  <SignedOut>
    1. In the Clerk Dashboard, navigate to the [**API Keys**](https://dashboard.clerk.com/last-active?path=api-keys) page.
    1. In the **Quick Copy** section, copy your Clerk publishable and secret key.
    1. Paste your keys into your `.env.local` file.

    The final result should resemble the following:
  </SignedOut>

  ```env {{ filename: '.env' }}
  PUBLIC_CLERK_PUBLISHABLE_KEY={{pub_key}}
  CLERK_SECRET_KEY={{secret}}
  ```

  ### Update `astro.config.mjs`

  To configure Clerk in your Astro app, you will need to update your `astro.config.mjs`.

  - Add the Clerk integration to the `integrations` list.
  - Install an [SSR adapter](https://docs.astro.build/en/guides/server-side-rendering/#official-adapters). This quickstart uses the [`@astrojs/node`](https://docs.astro.build/en/guides/integrations-guide/node/) adapter.
  - Set `output` to `server`. This is required when deploying to a host supporting SSR.

  ```ts {{ filename: 'astro.config.mjs', mark: [2, 3, [6, 8]] }}
  import { defineConfig } from 'astro/config'
  import node from '@astrojs/node'
  import clerk from '@clerk/astro'

  export default defineConfig({
    integrations: [clerk()],
    adapter: node({ mode: 'standalone' }),
    output: 'server',
  })
  ```

  ### Add `clerkMiddleware()` to your app

  [`clerkMiddleware()`](/docs/references/astro/clerk-middleware) grants you access to user authentication state throughout your app, on any route or page. It also allows you to protect specific routes from unauthenticated users. To add `clerkMiddleware()` to your app, follow these steps:

  1. Create a `middleware.ts` file.
     - If you're using the `/src` directory, create `middleware.ts` in the `/src` directory.
     - If you're not using the `/src` directory, create `middleware.ts` in the root directory alongside `.env.local`.
  1. In your `middleware.ts` file, export an `onRequest` constant and assign the result of the `clerkMiddleware()` function to it.
     ```tsx {{ filename: 'src/middleware.ts' }}
     import { clerkMiddleware } from '@clerk/astro/server'

     export const onRequest = clerkMiddleware()
     ```
  1. By default, `clerkMiddleware()` will not protect any routes. All routes are public and you must opt-in to protection for routes. See the [`clerkMiddleware()` reference](/docs/references/astro/clerk-middleware) to learn how to require authentication for specific routes.

  ### Add TypeScript declarations

  Update the `env.d.ts` file in your `src/` directory to add type definitions for the `locals` added by the middleware.

  ```ts {{ prettier: false, filename: 'src/env.d.ts', mark: [3] }}
  // The line directly below will only be present if you've ran your app
  // Don't worry about adding it manually
  /// <reference path="../.astro/types.d.ts" />

  /// <reference types="astro/client" />
  /// <reference types="@clerk/astro/env" />
  ```

  ### Add Clerk components to your app

  You can control which content signed-in and signed-out users can see with Clerk's [prebuilt control components](/docs/components/overview#what-are-control-components). Create a header using the following components:

  - [`<SignedIn>`](/docs/components/control/signed-in): Children of this component can only be seen while **signed in**.
  - [`<SignedOut>`](/docs/components/control/signed-out): Children of this component can only be seen while **signed out**.
  - [`<UserButton />`](/docs/components/user/user-button): Shows the signed-in user's avatar. Selecting it opens a dropdown menu with account management options.
  - [`<SignInButton />`](/docs/components/unstyled/sign-in-button): An unstyled component that links to the sign-in page. In this example, since no props or [environment variables](/docs/deployments/clerk-environment-variables) are set for the sign-in URL, this component links to the [Account Portal sign-in page.](/docs/customization/account-portal/overview#sign-in)

  ```astro {{ filename: 'src/layouts/SiteLayout.astro' }}
  ---
  import { SignedIn, SignedOut, UserButton, SignInButton } from '@clerk/astro/components'
  ---

  <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
      <meta name="generator" content={Astro.generator} />
    </head>
    <body>
      <header>
        <h1>{title}</h1>
        <nav>
          <SignedOut>
            <SignInButton mode="modal" />
          </SignedOut>
          <SignedIn>
            <UserButton />
          </SignedIn>
        </nav>
      </header>
      <article>
        <slot />
      </article>
    </body>
  </html>
  ```

  Then, use the layout on your homepage:

  ```astro {{ filename: 'src/pages/index.astro' }}
  ---
  import SiteLayout from '../layouts/SiteLayout.astro'
  ---

  <SiteLayout title="Clerk + Astro">
    <p>Sign in to try Clerk out!</p>
  </SiteLayout>
  ```

  ### Create your first user

  Run your project with the following command:

  <CodeBlockTabs options={["npm", "yarn", "pnpm"]}>
    ```bash {{ filename: 'terminal' }}
    npm run dev
    ```

    ```bash {{ filename: 'terminal' }}
    yarn dev
    ```

    ```bash {{ filename: 'terminal' }}
    pnpm dev
    ```
  </CodeBlockTabs>

  Now visit your app's homepage at [`http://localhost:4321`](http://localhost:4321). Sign up to create your first user.
</Steps>

## Next steps

<Cards>
  - [Protect routes using Clerk Middleware](/docs/references/astro/clerk-middleware)
  - Learn how to protect specific routes from unauthenticated users.

  ---

  - [Read session and user data](/docs/references/astro/read-session-data)
  - Learn how to use Clerk's stores and helpers to access the active session and user data in your Astro app.

  ---

  - [Clerk + Astro Quickstart Repo](https://github.com/clerk/clerk-astro-quickstart)
  - The official companion repo for Clerk's Astro Quickstart.
</Cards>
