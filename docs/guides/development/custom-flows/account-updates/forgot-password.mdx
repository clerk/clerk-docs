---
title: Build a custom flow for resetting a user's password
description: Learn how to build a custom flow using Clerk's API to reset a user's password.
---

<Include src="_partials/custom-flows-callout" />

<If sdk={["nextjs", "react", "expo", "js-frontend", "react-router", "tanstack-react-start"]}>
  > [!IMPORTANT]
  > This guide applies to the following Clerk SDKs:
  >
  > - `@clerk/react` v6 or higher
  > - `@clerk/nextjs` v7 or higher
  > - `@clerk/expo` v3 or higher
  > - `@clerk/react-router` v3 or higher
  > - `@clerk/tanstack-react-start` v0.26.0 or higher
  >
  > If you're using an older version of one of these SDKs, or are using the legacy API, refer to the [legacy API documentation](/docs/guides/development/custom-flows/account-updates/legacy/forgot-password).
</If>

The password reset flow works as follows:

1. Users can have an email address or phone number, or both. The user enters their email address or phone number and asks for a password reset code.
1. Clerk sends an email or SMS to the user, containing a code.
1. The user enters the code and a new password.
1. Clerk verifies the code, and if successful, updates the user's password and signs them in.

This guide demonstrates how to use Clerk's API to build a custom flow for resetting a user's password. It covers the following scenarios:

- [The user has an email address as an identifier](#email-address)
- [The user has a phone number as an identifier](#phone-number)

## Email address

<If notSdk={["js-frontend", "expo", "ios", "android", "nuxt"]}>
  **This example is written for Next.js App Router but it can be adapted for any React-based framework, such as React Router or Tanstack React Start.**

  ```tsx {{ filename: 'app/components/forgot-password.tsx', collapsible: true }}
  'use client'
  import React from 'react'
  import { useSignIn } from '@clerk/nextjs'
  import { useRouter } from 'next/navigation'

  export default function ForgotPassword() {
    const { signIn, errors, fetchStatus } = useSignIn()
    const router = useRouter()

    const [emailAddress, setEmailAddress] = React.useState('')
    const [code, setCode] = React.useState('')
    const [password, setPassword] = React.useState('')
    const [codeSent, setCodeSent] = React.useState(false)

    async function sendCode(e: React.FormEvent) {
      e.preventDefault()

      const { error: createError } = await signIn.create({
        identifier: emailAddress,
      })
      if (createError) {
        console.error(JSON.stringify(createError, null, 2))
        return
      }

      const { error: sendCodeError } = await signIn.resetPasswordEmailCode.sendCode()
      if (sendCodeError) {
        console.error(JSON.stringify(sendCodeError, null, 2))
        return
      }

      setCodeSent(true)
    }

    async function verifyCode(e: React.FormEvent) {
      e.preventDefault()

      const { error } = await signIn.resetPasswordEmailCode.verifyCode({
        code,
      })
      if (error) {
        console.error(JSON.stringify(error, null, 2))
        return
      }
    }

    async function submitNewPassword(e: React.FormEvent) {
      e.preventDefault()

      const { error } = await signIn.resetPasswordEmailCode.submitPassword({
        password,
      })
      if (error) {
        console.error(JSON.stringify(error, null, 2))
        return
      }

      if (signIn.status === 'needs_second_factor') {
        // See https://clerk.com/docs/guides/development/custom-flows/authentication/second-factor
        return
      }

      if (signIn.status === 'complete') {
        const { error } = await signIn.finalize({
          navigate: async ({ session, decorateUrl }) => {
            if (session?.currentTask) {
              // Handle session tasks
              // See https://clerk.com/docs/guides/development/custom-flows/authentication/session-tasks
              console.log(session.currentTask)
              return
            }

            const url = decorateUrl('/')
            if (url.startsWith('http')) {
              window.location.href = url
            } else {
              router.push(url)
            }
          },
        })

        if (error) {
          console.error(JSON.stringify(error, null, 2))
          return
        }
      }
    }

    return (
      <div>
        <h1>Forgot Password?</h1>

        {!codeSent && (
          <form onSubmit={sendCode}>
            <label htmlFor="emailAddress">Provide your email address</label>
            <input
              id="emailAddress"
              type="email"
              placeholder="e.g john@doe.com"
              value={emailAddress}
              onChange={(e) => setEmailAddress(e.target.value)}
            />
            {errors.fields.identifier && <p>{errors.fields.identifier.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Send password reset code
            </button>
          </form>
        )}

        {codeSent && signIn.status !== 'needs_new_password' && (
          <form onSubmit={verifyCode}>
            <label htmlFor="code">Enter the password reset code that was sent to your email</label>
            <input id="code" type="text" value={code} onChange={(e) => setCode(e.target.value)} />
            {errors.fields.code && <p>{errors.fields.code.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Verify code
            </button>
          </form>
        )}

        {signIn.status === 'needs_new_password' && (
          <form onSubmit={submitNewPassword}>
            <label htmlFor="password">Enter your new password</label>
            <input
              id="password"
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
            />
            {errors.fields.password && <p>{errors.fields.password.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Set new password
            </button>
          </form>
        )}

        {signIn.status === 'needs_second_factor' && (
          <p>2FA is required, but this UI does not handle that.</p>
        )}

        {/* For your debugging purposes. You can just console.log errors, but we put them in the UI for convenience */}
        {errors && <pre>{JSON.stringify(errors, null, 2)}</pre>}
      </div>
    )
  }
  ```
</If>

<If sdk="expo">
  {/* TODO: Add Expo example */}
</If>

<If sdk="ios">
  ```swift {{ filename: 'ForgotPasswordView.swift', collapsible: true }}
  import SwiftUI
  import Clerk

  struct ForgotPasswordView: View {
    @Environment(Clerk.self) private var clerk
    @State private var email = ""
    @State private var code = ""
    @State private var newPassword = ""
    @State private var isVerifying = false

    var body: some View {
      switch clerk.client?.signIn?.status {
      case .needsFirstFactor:
        TextField("Enter your code", text: $code)
        Button("Verify") {
          Task { await verify(code: code) }
        }

      case .needsSecondFactor:
        Text("2FA is required, but this UI does not handle that")

      case .needsNewPassword:
        SecureField("New password", text: $newPassword)
        Button("Set new password") {
          Task { await setNewPassword(password: newPassword) }
        }

      default:
        if let session = clerk.session {
          Text("Active Session: \(session.id)")
        } else {
          TextField("Email", text: $email)
          Button("Forgot password?") {
            Task { await createSignIn(email: email) }
          }
        }
      }
    }
  }
  ```
</If>

<If sdk="android">
  <CodeBlockTabs options={["ForgotPasswordEmailViewModel", "ForgotPasswordEmailActivity"]}>
    ```kotlin {{ filename: 'ForgotPasswordEmailViewModel.kt', collapsible: true }}
      import android.util.Log
      import androidx.lifecycle.ViewModel
      import androidx.lifecycle.viewModelScope
      import com.clerk.api.Clerk
      import com.clerk.api.network.serialization.errorMessage
      import com.clerk.api.network.serialization.onFailure
      import com.clerk.api.network.serialization.onSuccess
      import com.clerk.api.signin.SignIn
      import com.clerk.api.signin.attemptFirstFactor
      import com.clerk.api.signin.resetPassword
      import kotlinx.coroutines.flow.MutableStateFlow
      import kotlinx.coroutines.flow.asStateFlow
      import kotlinx.coroutines.flow.combine
      import kotlinx.coroutines.flow.launchIn
      import kotlinx.coroutines.launch

      class ForgotPasswordEmailViewModel : ViewModel() {
        private val _uiState = MutableStateFlow<UiState>(UiState.Loading)
        val uiState = _uiState.asStateFlow()

        init {
          combine(Clerk.isInitialized, Clerk.userFlow) { isInitialized, user ->
              _uiState.value =
                when {
                  !isInitialized -> UiState.Loading
                  user != null -> UiState.Complete
                  else -> UiState.SignedOut
                }
            }
            .launchIn(viewModelScope)
        }

        fun createSignIn(email: String) {
          viewModelScope.launch {
            SignIn.create(SignIn.CreateParams.Strategy.ResetPasswordEmailCode(identifier = email))
              .onSuccess { updateStateFromStatus(it.status) }
              .onFailure {
                // See https://clerk.com/docs/guides/development/custom-flows/error-handling
                // for more info on error handling
                Log.e(
                  ForgotPasswordEmailViewModel::class.simpleName,
                  it.errorMessage,
                  it.throwable,
                )
              }
          }
        }

        fun verify(code: String) {
          val inProgressSignIn = Clerk.signIn ?: return
          viewModelScope.launch {
            inProgressSignIn
              .attemptFirstFactor(SignIn.AttemptFirstFactorParams.ResetPasswordEmailCode(code))
              .onSuccess { updateStateFromStatus(it.status) }
              .onFailure {
                // See https://clerk.com/docs/guides/development/custom-flows/error-handling
                // for more info on error handling
                Log.e(
                  ForgotPasswordEmailViewModel::class.simpleName,
                  it.errorMessage,
                  it.throwable,
                )
              }
          }
        }

        fun setNewPassword(password: String) {
          val inProgressSignIn = Clerk.signIn ?: return
          viewModelScope.launch {
            inProgressSignIn
              .resetPassword(SignIn.ResetPasswordParams(password))
              .onSuccess { updateStateFromStatus(it.status) }
              .onFailure {
                // See https://clerk.com/docs/guides/development/custom-flows/error-handling
                // for more info on error handling
                Log.e(
                  ForgotPasswordEmailViewModel::class.simpleName,
                  it.errorMessage,
                  it.throwable,
                )
              }
          }
        }

        fun updateStateFromStatus(status: SignIn.Status) {
          val state =
            when (status) {
              SignIn.Status.COMPLETE -> UiState.Complete
              SignIn.Status.NEEDS_FIRST_FACTOR -> UiState.NeedsFirstFactor
              SignIn.Status.NEEDS_SECOND_FACTOR -> UiState.NeedsSecondFactor
              SignIn.Status.NEEDS_NEW_PASSWORD -> UiState.NeedsNewPassword
              else -> {
                UiState.SignedOut
              }
            }

          _uiState.value = state
        }

        sealed interface UiState {
          data object Loading : UiState
          data object SignedOut : UiState
          data object NeedsFirstFactor : UiState
          data object NeedsSecondFactor : UiState
          data object NeedsNewPassword : UiState
          data object Complete : UiState
        }
      }
    ```

    ```kotlin {{ filename: 'ForgotPasswordEmailActivity.kt', collapsible: true }}
      import android.os.Bundle
      import androidx.activity.ComponentActivity
      import androidx.activity.compose.setContent
      import androidx.activity.viewModels
      import androidx.compose.foundation.layout.Arrangement.Absolute.spacedBy
      import androidx.compose.foundation.layout.Box
      import androidx.compose.foundation.layout.Column
      import androidx.compose.foundation.layout.fillMaxSize
      import androidx.compose.material3.Button
      import androidx.compose.material3.CircularProgressIndicator
      import androidx.compose.material3.Text
      import androidx.compose.material3.TextField
      import androidx.compose.runtime.Composable
      import androidx.compose.runtime.getValue
      import androidx.compose.runtime.mutableStateOf
      import androidx.compose.runtime.remember
      import androidx.compose.runtime.setValue
      import androidx.compose.ui.Alignment
      import androidx.compose.ui.Modifier
      import androidx.compose.ui.text.input.PasswordVisualTransformation
      import androidx.compose.ui.text.input.VisualTransformation
      import androidx.compose.ui.unit.dp
      import androidx.lifecycle.compose.collectAsStateWithLifecycle
      import com.clerk.api.Clerk

      class ForgotPasswordEmailActivity : ComponentActivity() {
        val viewModel: ForgotPasswordEmailViewModel by viewModels()

        override fun onCreate(savedInstanceState: Bundle?) {
          super.onCreate(savedInstanceState)
          setContent {
            val state by viewModel.uiState.collectAsStateWithLifecycle()
            ForgotPasswordView(
              state,
              onVerify = viewModel::verify,
              onSetNewPassword = viewModel::setNewPassword,
              onCreateSignIn = viewModel::createSignIn,
            )
          }
        }
      }

      @Composable
      fun ForgotPasswordView(
        state: ForgotPasswordEmailViewModel.UiState,
        onVerify: (String) -> Unit,
        onSetNewPassword: (String) -> Unit,
        onCreateSignIn: (String) -> Unit,
      ) {

        Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
          when (state) {
            ForgotPasswordEmailViewModel.UiState.Complete -> {
              Text("Active session: ${Clerk.session?.id}")
            }

            ForgotPasswordEmailViewModel.UiState.NeedsFirstFactor -> {
              InputContent(placeholder = "Enter your code", buttonText = "Verify", onClick = onVerify)
            }
            ForgotPasswordEmailViewModel.UiState.NeedsNewPassword -> {
              InputContent(
                placeholder = "Enter your new password",
                buttonText = "Set new password",
                onClick = onSetNewPassword,
                visualTransformation = PasswordVisualTransformation(),
              )
            }
            ForgotPasswordEmailViewModel.UiState.NeedsSecondFactor -> {
              Text("2FA is required but this UI does not handle that")
            }
            ForgotPasswordEmailViewModel.UiState.SignedOut -> {
              InputContent(
                placeholder = "Enter your email address",
                buttonText = "Forgot password?",
                onClick = onCreateSignIn,
              )
            }

            ForgotPasswordEmailViewModel.UiState.Loading -> CircularProgressIndicator()
          }
        }
      }

      @Composable
      fun InputContent(
        placeholder: String,
        buttonText: String,
        visualTransformation: VisualTransformation = VisualTransformation.None,
        onClick: (String) -> Unit,
      ) {
        var value by remember { mutableStateOf("") }
        Column(
          horizontalAlignment = Alignment.CenterHorizontally,
          verticalArrangement = spacedBy(16.dp, Alignment.CenterVertically),
        ) {
          TextField(
            value = value,
            onValueChange = { value = it },
            visualTransformation = visualTransformation,
            placeholder = { Text(placeholder) },
          )
          Button(onClick = { onClick(value) }) { Text(buttonText) }
        }
      }
    ```
  </CodeBlockTabs>
</If>

<If sdk={["js-frontend", "nuxt"]}>
  <Include src="_partials/sdk-examples-not-available-callout" />
</If>

## Phone number

<If notSdk={["js-frontend", "expo", "ios", "android", "nuxt"]}>
  **This example is written for Next.js App Router but it can be adapted for any React-based framework, such as React Router or Tanstack React Start.**

  ```tsx {{ filename: 'app/components/forgot-password.tsx', collapsible: true }}
  'use client'
  import React from 'react'
  import { useSignIn } from '@clerk/nextjs'
  import { useRouter } from 'next/navigation'

  export default function ForgotPassword() {
    const { signIn, errors, fetchStatus } = useSignIn()
    const router = useRouter()

    const [phoneNumber, setPhoneNumber] = React.useState('')
    const [code, setCode] = React.useState('')
    const [password, setPassword] = React.useState('')
    const [codeSent, setCodeSent] = React.useState(false)

    async function sendCode(e: React.FormEvent) {
      e.preventDefault()

      const { error: createError } = await signIn.create({
        identifier: phoneNumber,
      })
      if (createError) {
        console.error(JSON.stringify(createError, null, 2))
        return
      }

      const { error: sendCodeError } = await signIn.resetPasswordPhoneCode.sendCode()
      if (sendCodeError) {
        console.error(JSON.stringify(sendCodeError, null, 2))
        return
      }

      setCodeSent(true)
    }

    async function verifyCode(e: React.FormEvent) {
      e.preventDefault()

      const { error } = await signIn.resetPasswordPhoneCode.verifyCode({
        code,
      })
      if (error) {
        console.error(JSON.stringify(error, null, 2))
        return
      }
    }

    async function submitNewPassword(e: React.FormEvent) {
      e.preventDefault()

      const { error } = await signIn.resetPasswordPhoneCode.submitPassword({
        password,
      })
      if (error) {
        console.error(JSON.stringify(error, null, 2))
        return
      }

      if (signIn.status === 'needs_second_factor') {
        // See https://clerk.com/docs/guides/development/custom-flows/authentication/second-factor
        return
      }

      if (signIn.status === 'complete') {
        const { error } = await signIn.finalize({
          navigate: async ({ session, decorateUrl }) => {
            if (session?.currentTask) {
              // Handle session tasks
              // See https://clerk.com/docs/guides/development/custom-flows/authentication/session-tasks
              console.log(session.currentTask)
              return
            }

            const url = decorateUrl('/')
            if (url.startsWith('http')) {
              window.location.href = url
            } else {
              router.push(url)
            }
          },
        })

        if (error) {
          console.error(JSON.stringify(error, null, 2))
          return
        }
      }
    }

    return (
      <div>
        <h1>Forgot Password?</h1>

        {!codeSent && (
          <form onSubmit={sendCode}>
            <label htmlFor="phoneNumber">Provide your phone number</label>
            <input
              id="phoneNumber"
              type="phoneNumber"
              placeholder="e.g +1234567890"
              value={phoneNumber}
              onChange={(e) => setPhoneNumber(e.target.value)}
            />
            {errors.fields.identifier && <p>{errors.fields.identifier.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Send password reset code
            </button>
          </form>
        )}

        {codeSent && signIn.status !== 'needs_new_password' && (
          <form onSubmit={verifyCode}>
            <label htmlFor="code">
              Enter the password reset code that was sent to your phone number
            </label>
            <input id="code" type="text" value={code} onChange={(e) => setCode(e.target.value)} />
            {errors.fields.code && <p>{errors.fields.code.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Verify code
            </button>
          </form>
        )}

        {signIn.status === 'needs_new_password' && (
          <form onSubmit={submitNewPassword}>
            <label htmlFor="password">Enter your new password</label>
            <input
              id="password"
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
            />
            {errors.fields.password && <p>{errors.fields.password.message}</p>}
            <button type="submit" disabled={fetchStatus === 'fetching'}>
              Set new password
            </button>
          </form>
        )}

        {signIn.status === 'needs_second_factor' && (
          <p>2FA is required, but this UI does not handle that.</p>
        )}

        {/* For your debugging purposes. You can just console.log errors, but we put them in the UI for convenience */}
        {errors && <pre>{JSON.stringify(errors, null, 2)}</pre>}
      </div>
    )
  }
  ```
</If>

<If sdk="expo">
  {/* TODO: Add Expo example */}
</If>

<If sdk="ios">
  {/* TODO: Add iOS example */}
</If>

<If sdk="android">
  <CodeBlockTabs options={["ForgotPasswordPhoneViewModel", "ForgotPasswordPhoneActivity"]}>
    ```kotlin {{ filename: 'ForgotPasswordPhoneViewModel.kt', collapsible: true }}
    import android.util.Log
    import androidx.lifecycle.ViewModel
    import androidx.lifecycle.viewModelScope
    import com.clerk.api.Clerk
    import com.clerk.api.network.serialization.errorMessage
    import com.clerk.api.network.serialization.onFailure
    import com.clerk.api.network.serialization.onSuccess
    import com.clerk.api.signin.SignIn
    import com.clerk.api.signin.attemptFirstFactor
    import com.clerk.api.signin.resetPassword
    import kotlinx.coroutines.flow.MutableStateFlow
    import kotlinx.coroutines.flow.asStateFlow
    import kotlinx.coroutines.flow.combine
    import kotlinx.coroutines.flow.launchIn
    import kotlinx.coroutines.launch

    class ForgotPasswordPhoneViewModel : ViewModel() {
      private val _uiState = MutableStateFlow<UiState>(UiState.Loading)
      val uiState = _uiState.asStateFlow()

      init {
        combine(Clerk.isInitialized, Clerk.userFlow) { isInitialized, user ->
            _uiState.value =
              when {
                !isInitialized -> UiState.Loading
                user != null -> UiState.Complete
                else -> UiState.SignedOut
              }
          }
          .launchIn(viewModelScope)
      }

      fun createSignIn(phoneNumber: String) {
        viewModelScope.launch {
          SignIn.create(SignIn.CreateParams.Strategy.ResetPasswordPhoneCode(identifier = phoneNumber))
            .onSuccess { updateStateFromStatus(it.status) }
            .onFailure {
              // See https://clerk.com/docs/guides/development/custom-flows/error-handling
              // for more info on error handling
              Log.e(
                ForgotPasswordPhoneViewModel::class.simpleName,
                it.errorMessage,
                it.throwable,
              )
            }
        }
      }

      fun verify(code: String) {
        val inProgressSignIn = Clerk.signIn ?: return
        viewModelScope.launch {
          inProgressSignIn
            .attemptFirstFactor(SignIn.AttemptFirstFactorParams.ResetPasswordPhoneCode(code))
            .onSuccess { updateStateFromStatus(it.status) }
            .onFailure {
              // See https://clerk.com/docs/guides/development/custom-flows/error-handling
              // for more info on error handling
              Log.e(
                ForgotPasswordPhoneViewModel::class.simpleName,
                it.errorMessage,
                it.throwable,
              )
            }
        }
      }

      fun setNewPassword(password: String) {
        val inProgressSignIn = Clerk.signIn ?: return
        viewModelScope.launch {
          inProgressSignIn
            .resetPassword(SignIn.ResetPasswordParams(password))
            .onSuccess { updateStateFromStatus(it.status) }
            .onFailure {
              // See https://clerk.com/docs/guides/development/custom-flows/error-handling
              // for more info on error handling
              Log.e(
                ForgotPasswordPhoneViewModel::class.simpleName,
                it.errorMessage,
                it.throwable,
              )
            }
        }
      }

      fun updateStateFromStatus(status: SignIn.Status) {
        val state =
          when (status) {
            SignIn.Status.COMPLETE -> UiState.Complete
            SignIn.Status.NEEDS_FIRST_FACTOR -> UiState.NeedsFirstFactor
            SignIn.Status.NEEDS_SECOND_FACTOR -> UiState.NeedsSecondFactor
            SignIn.Status.NEEDS_NEW_PASSWORD -> UiState.NeedsNewPassword
            else -> {
              UiState.SignedOut
            }
          }

        _uiState.value = state
      }

      sealed interface UiState {
        data object Loading : UiState
        data object SignedOut : UiState
        data object NeedsFirstFactor : UiState
        data object NeedsSecondFactor : UiState
        data object NeedsNewPassword : UiState
        data object Complete : UiState
      }
    }

    ```

    ```kotlin {{ filename: 'ForgotPasswordPhoneActivity.kt', collapsible: true }}
      import android.os.Bundle
      import androidx.activity.ComponentActivity
      import androidx.activity.compose.setContent
      import androidx.activity.viewModels
      import androidx.compose.foundation.layout.Arrangement.Absolute.spacedBy
      import androidx.compose.foundation.layout.Box
      import androidx.compose.foundation.layout.Column
      import androidx.compose.foundation.layout.fillMaxSize
      import androidx.compose.material3.Button
      import androidx.compose.material3.CircularProgressIndicator
      import androidx.compose.material3.Text
      import androidx.compose.material3.TextField
      import androidx.compose.runtime.Composable
      import androidx.compose.runtime.getValue
      import androidx.compose.runtime.mutableStateOf
      import androidx.compose.runtime.remember
      import androidx.compose.runtime.setValue
      import androidx.compose.ui.Alignment
      import androidx.compose.ui.Modifier
      import androidx.compose.ui.text.input.PasswordVisualTransformation
      import androidx.compose.ui.text.input.VisualTransformation
      import androidx.compose.ui.unit.dp
      import androidx.lifecycle.compose.collectAsStateWithLifecycle
      import com.clerk.api.Clerk

      class ForgotPasswordPhoneActivity : ComponentActivity() {
          val viewModel: ForgotPasswordPhoneViewModel by viewModels()

          override fun onCreate(savedInstanceState: Bundle?) {
              super.onCreate(savedInstanceState)
              setContent {
                  val state by viewModel.uiState.collectAsStateWithLifecycle()
                  ForgotPasswordView(
                      state,
                      onVerify = viewModel::verify,
                      onSetNewPassword = viewModel::setNewPassword,
                      onCreateSignIn = viewModel::createSignIn,
                  )
              }
          }
      }

      @Composable
      fun ForgotPasswordView(
          state: ForgotPasswordPhoneViewModel.UiState,
          onVerify: (String) -> Unit,
          onSetNewPassword: (String) -> Unit,
          onCreateSignIn: (String) -> Unit,
      ) {

          Box(modifier = Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {
              when (state) {
                  ForgotPasswordPhoneViewModel.UiState.Complete -> {
                      Text("Active session: ${Clerk.session?.id}")
                  }
                  ForgotPasswordPhoneViewModel.UiState.NeedsFirstFactor -> {
                      InputContent(placeholder = "Enter your code", buttonText = "Verify", onClick = onVerify)
                  }
                  ForgotPasswordPhoneViewModel.UiState.NeedsNewPassword -> {
                      InputContent(
                          placeholder = "Enter your new password",
                          buttonText = "Set new password",
                          onClick = onSetNewPassword,
                          visualTransformation = PasswordVisualTransformation(),
                      )
                  }
                  ForgotPasswordPhoneViewModel.UiState.NeedsSecondFactor -> {
                      Text("2FA is required but this UI does not handle that")
                  }
                  ForgotPasswordPhoneViewModel.UiState.SignedOut -> {
                      InputContent(
                          placeholder = "Enter your phone number",
                          buttonText = "Forgot password?",
                          onClick = onCreateSignIn,
                      )
                  }

                  ForgotPasswordPhoneViewModel.UiState.Loading -> CircularProgressIndicator()
              }
          }
      }

      @Composable
      fun InputContent(
          placeholder: String,
          buttonText: String,
          visualTransformation: VisualTransformation = VisualTransformation.None,
          onClick: (String) -> Unit,
      ) {
          var value by remember { mutableStateOf("") }
          Column(
              horizontalAlignment = Alignment.CenterHorizontally,
              verticalArrangement = spacedBy(16.dp, Alignment.CenterVertically),
          ) {
              TextField(
                  value = value,
                  onValueChange = { value = it },
                  visualTransformation = visualTransformation,
                  placeholder = { Text(placeholder) },
              )
              Button(onClick = { onClick(value) }) { Text(buttonText) }
          }
      }
    ```
  </CodeBlockTabs>
</If>

<If sdk={["js-frontend", "ios", "nuxt"]}>
  <Include src="_partials/sdk-examples-not-available-callout" />
</If>

## Handle compromised passwords

If you have enabled [rejection of compromised passwords also on sign-in](/docs/guides/secure/password-protection-and-rules#reject-compromised-passwords), then it is possible for the sign-in attempt to be rejected with the `form_password_pwned` error code.

In this case, you can prompt the user to reset their password using the exact same logic detailed in the previous section.
