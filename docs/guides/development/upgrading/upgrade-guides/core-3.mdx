---
title: "Upgrading to Clerk Core 3"
description: "Find SDK-specific guides for upgrading to Clerk Core 3."
---

## SDK Guides

Core 3 brings UI and breaking code changes. We expect upgrades to take less than 30 minutes and provide a CLI to assist. Select your framework below to get started.

<Tabs items={['Next.js']}>
  <Tab>
    ### Upgrading `@clerk/nextjs` to Core 3

    Core 3 for Next.js tightens platform requirements, removes deprecated redirect props, and introduces a new client-side authorization component. Use this guide to prepare before installing `@clerk/nextjs@latest`.

    #### Preparing to upgrade

    - **Node.js**: Use Node `20.9.0` or newer. Older runtimes are no longer supported.
    - **Next.js**: Use Next.js `15.2.3` or newer. Support for Next 13 and 14 has been dropped.
    - **React**: React 18+ remains required.

    #### CLI upgrade helper

    The `@clerk/upgrade` CLI understands Core 3 changes, installs the latest SDK for you, and ships a `transform-protect-to-show` codemod.

    <Tabs items={['npm', 'pnpm', 'yarn']}>
      <Tab>
        ```bash
        npx @clerk/upgrade@latest
        ```
      </Tab>

      <Tab>
        ```bash
        pnpm dlx @clerk/upgrade@latest
        ```
      </Tab>

      <Tab>
        ```bash
        yarn dlx @clerk/upgrade@latest
        ```
      </Tab>
    </Tabs>

    Running the CLI updates dependencies and applies codemods. If you prefer a manual upgrade, skip this step and use the install commands below. The CLIâ€™s `transform-protect-to-show` codemod migrates client-side `<Protect>` usage to `<Show>` and updates imports automatically. Use the previous CLI major if you must target an older Clerk release.

    #### Manual installation (alternative)

    If you want to skip the CLI, install the SDK directly:

    <Tabs items={['npm', 'pnpm', 'yarn']}>
      <Tab>
        ```bash
        npm install @clerk/nextjs@latest
        ```
      </Tab>

      <Tab>
        ```bash
        pnpm add @clerk/nextjs@latest
        ```
      </Tab>

      <Tab>
        ```bash
        yarn add @clerk/nextjs@latest
        ```
      </Tab>
    </Tabs>

    #### Breaking changes

    **Authorization components**

    - `<Protect>` is now limited to App Router server usage.
    - Use the new `<Show when={...}>` component for client-side authorization checks.

    Example migration:

    ```tsx
    'use client'

    import { Show } from '@clerk/nextjs'

    export default function DashboardGate({ children }) {
      return <Show when={{ role: 'org:admin' }}>{children}</Show>
    }
    ```

    For server components and Middleware, continue using `auth().protect` or `clerkMiddleware`.

    **Middleware encryption key**

    When you pass `secretKey` to `clerkMiddleware` at runtime you must also provide `CLERK_ENCRYPTION_KEY` in the environment. Missing keys now throw an error during startup.

    **Removed deprecated props and helpers**

    Core 3 removes the redirect and UI props that were deprecated in Core 2:

    - `afterSignInUrl`, `afterSignUpUrl`, and `redirectUrl` props are removed. Use the Core 2 redirect options (for example `signInFallbackRedirectUrl` or `signInForceRedirectUrl`) or handle redirects in Middleware.
    - `UserButton` sign-out override props are removed. Use the redirect options instead.
    - Organization `hideSlug` flags and `OrganizationSwitcher` `afterSwitchOrganizationUrl` are removed; rely on the default UI or navigate in an `onOrganizationSwitched` handler.
    - `Client.activeSessions`, `setActive({ beforeEmit })`, and the `ClerkMiddlewareAuthObject` type alias are no longer exported.

    **Internal API prefix changes**

    Experimental and unstable APIs were renamed for consistency. For Next.js, rename `__unstable_invokeMiddlewareOnAuthStateChange` to `__internal_invokeMiddlewareOnAuthStateChange`. Other `__unstable*` and `experimental*` exports in `@clerk/*` packages now use the `__internal` or `__experimental` prefixes.
  </Tab>
</Tabs>

> [!NOTE]
> Additional Core 3 SDK guides will be added here as they become available.
