---
description: Learn how to build a custom flow for managing users in an organization using Clerk's API.
---

# Build a custom flow for managing members in an organization

<Callout type="danger">
  This guide is for users who want to build a *custom* user interface using the Clerk API. To invite users to an organization using a *prebuilt* UI, you should use Clerk's [prebuilt components](/docs/components/overview).
</Callout>

Organization members with appropriate [permissions](/docs/organizations/roles-permissions#permissions) can manage member [roles](/docs/organizations/roles-permissions#roles) within an organization, including changing a member's role, removing them from an organization, and revoking organization invitations.

This is a fully comprehensive example that demonstrates how to create the following:
- A list of membership requests.
- A list of organization memberships, where the user can change member roles or remove members from the organization.

The [`useOrganization()`](/docs/references/react/use-organization) hook can be used to retrieve the current user's membership or the list of memberships for the currently active organization. The [`destroy`](/docs/references/javascript/organization-membership#destroy) and [`update`](/docs/references/javascript/organization-membership#update) methods can be called on the membership object to remove a member or change their role.

The [`useOrganization()`](/docs/references/react/use-organization) hook can also be used to retrieve the list of invitations for the currently active organization. The [`revoke`](/docs/references/javascript/organization-invitation#revoke) method can be called on the `OrganizationInvitation` object to revoke the invitation.

Methods for [changing a member's role](/docs/references/backend/organization/update-organization-membership), [removing a member](/docs/references/backend/organization/delete-organization-membership), and [revoking an invitation](/docs/references/backend/organization/revoke-organization-invitation) are also available on the [Backend API](/docs/references/backend/overview).

## Create

<Tabs items={["Next.js", "JavaScript"]}>
  <Tab>
  ```tsx filename="pages/organizations/[id].tsx"
  import { useState, useEffect, ChangeEventHandler, useRef } from "react"
  import { useOrganization, useUser } from "@clerk/nextjs"
  import type { OrganizationCustomRoleKey } from "@clerk/types"

  export const OrgMembersParams = {
    memberships: {
      pageSize: 5,
      keepPreviousData: true,
    },
  }

  // View and manage active organization members,
  // along with any pending invitations.
  // Invite new members.
  export default function Organization() {
    const {
      organization: currentOrganization,
      isLoaded,
    } = useOrganization();

    if (!isLoaded || !currentOrganization) {
      return null;
    }

    return (
      <>
        <h1>Organization: {currentOrganization.name}</h1>
        <h2 className="mb-6 mt-12">Custom List Memberships</h2>
        <OrgMembers />
      </>
    );
  }

  // List of organization memberships. Administrators can
  // change member roles or remove members from the organization.
  export const OrgMembers = () => {
    const { user } = useUser()
    const { isLoaded, memberships } = useOrganization(OrgMembersParams)

    if (!isLoaded) {
      return <>Loading</>
    }

    return (
      <>
        <table>
          <thead>
            <tr>
              <th>User</th>
              <th>Joined</th>
              <th>Role</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {memberships?.data?.map((mem) => (
              <tr key={mem.id}>
                <td>
                  {mem.publicUserData.identifier}{" "}
                  {mem.publicUserData.userId === user?.id && "(You)"}
                </td>
                <td>{mem.createdAt.toLocaleDateString()}</td>
                <td>
                  <SelectRole
                    defaultRole={mem.role}
                    onChange={async (e) => {
                      await mem.update({
                        role: e.target.value as OrganizationCustomRoleKey,
                      })
                      await memberships?.revalidate()
                    }}
                  />
                </td>
                <td>
                  <button
                    onClick={async () => {
                      await mem.destroy()
                      await memberships?.revalidate()
                    }}
                  >
                    Remove
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </table>

        <div className="flex">
          <button
            className="inline-block"
            disabled={!memberships?.hasPreviousPage || memberships?.isFetching}
            onClick={() => memberships?.fetchPrevious?.()}
          >
            Previous
          </button>

          <button
            className="inline-block"
            disabled={!memberships?.hasNextPage || memberships?.isFetching}
            onClick={() => memberships?.fetchNext?.()}
          >
            Next
          </button>
        </div>
      </>
    )
  }
  ```
  </Tab>

  <Tab>
    <CodeBlockTabs options={["index.html", "main.js"]}>
    ```html
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Clerk + JavaScript App</title>
      </head>
      <body>
        <div id="app"></div>

        <h2>Memberships List</h2>
        <ul id="memberships_list"></ul>

        <h2>Invitations List</h2>
        <ul id="invitations_list"></ul>

        <h2>Send a new invitation</h2>
        <form id="new_invitation">
          <div>
            <label>Email address</label>
            <br />
            <input type="email" id="email_address" name="email_address" />
          </div>
          <button>Invite</button>
        </form>

        <script
          type="module"
          src="/src/main.js"
          async
          crossorigin="anonymous"
        ></script>
      </body>
    </html>
    ```

    ```js filename="main.js"
    import { Clerk } from '@clerk/clerk-js';

    const pubKey = import.meta.env.VITE_CLERK_PUBLISHABLE_KEY;

    if (!pubKey) {
      throw new Error('Add your VITE_CLERK_PUBLISHABLE_KEY to .env file');
    }

    const clerk = new Clerk('{{pub_key}}');
    await clerk.load();

    if (clerk.user) {
      // Render list of organization memberships
      const data = await clerk.user.getOrganizationMemberships();
      console.log(`Organization Memberships:`, data);

      async function renderMemberships(organization, isAdmin) {
        const list = document.getElementById('memberships_list');
        try {
          const { data } = await organization.getMemberships();
          const memberships = data;
          console.log(`getMemberships:`, memberships);

          memberships.map((membership) => {
            const li = document.createElement('li');
            li.textContent = `ID: ${membership.id} Identifier: ${membership.publicUserData.identifier} UserId: ${membership.publicUserData.userId} Role: ${membership.role} Permissions: ${membership.permissions}`;

            // Add administrative actions; update role and remove member.
            if (isAdmin) {
              const updateBtn = document.createElement('button');
              updateBtn.textContent = 'Change role';
              updateBtn.addEventListener('click', async function (e) {
                e.preventDefault();
                const role = membership.role === 'admin' ? 'org:member' : 'admin';
                await membership.update({ role });
              });
              li.appendChild(updateBtn);

              const removeBtn = document.createElement('button');
              removeBtn.textContent = 'Remove';
              removeBtn.addEventListener('click', async function (e) {
                e.preventDefault();
                await currentOrganization.removeMember(membership.userId);
              });
              li.appendChild(removeBtn);
            }

            // Add the entry to the list
            list.appendChild(li);
          });
        } catch (err) {
          console.error(err);
        }
      }

      // Render list of organization invitations
      async function renderInvitations(organization, isAdmin) {
        const list = document.getElementById('invitations_list');
        try {
          const { totalCount, data } = await organization.getInvitations();

          const invitations = data;

          if (invitations.length === 0) {
            list.textContent = 'No invitations';
          }

          invitations.map((invitation) => {
            const li = document.createElement('li');
            li.textContent = `${invitation.emailAddress} - ${invitation.role}`;

            // Add administrative actions; revoke invitation
            if (isAdmin) {
              const revokeBtn = document.createElement('button');
              revokeBtn.textContent = 'Revoke';
              revokeBtn.addEventListener('click', async function (e) {
                e.preventDefault();
                await invitation.revoke();
              });
              li.appendChild(revokeBtn);
            }
            // Add the entry to the list
            list.appendChild(li);
          });
        } catch (err) {
          console.error(err);
        }
      }

      // Gets the current org, checks if the current user is an admin,
      // renders memberships and invitations, and sets up the new invitation form.
      async function init() {
        // This is the current organization ID.
        const organizationId = clerk.organization.id;

        const { data } = await clerk.user.getOrganizationMemberships();
        const organizationMemberships = data;

        const currentMembership = organizationMemberships.find(
          (membership) => membership.organization.id === organizationId
        );
        const currentOrganization = currentMembership.organization;

        if (!currentOrganization) {
          return;
        }
        const isAdmin = currentMembership.role === 'org:admin';

        renderMemberships(currentOrganization, isAdmin);
        renderInvitations(currentOrganization, isAdmin);

        if (isAdmin) {
          const form = document.getElementById('new_invitation');
          form.addEventListener('submit', async function (e) {
            e.preventDefault();
            const inputEl = document.getElementById('email_address');
            if (!inputEl) {
              return;
            }

            try {
              console.log(inputEl.value);
              await currentOrganization.inviteMember({
                emailAddress: inputEl.value,
                role: 'org:member',
              });
            } catch (err) {
              console.error(err);
            }
          });
        }
      }

      init();
    } else {
      // Mount sign in component
      document.getElementById('app').innerHTML = `
        <div id="sign-in"></div>
      `;

      const signInDiv = document.getElementById('sign-in');

      clerk.mountSignIn(signInDiv);
    }
    ```
    </CodeBlockTabs>
  </Tab>
</Tabs>

{/* TODO: Should we mention the update method on the OrganizationMembership object? Or the updateMember method on the Organization object? Or the updateOrganizationMembership method from the Backend API? */}

{/* TODO: Add section for ## Remove members , and add appropriate examples ? */}
