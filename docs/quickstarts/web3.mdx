---
title: Use Clerk with Web3
description: Learn to install and initialize Clerk in a new Web3 application.
---

# Use Clerk with Web3

Learn how to use Clerk to quickly and easily add secure authentication and user management to your Web3 application.

## Before you start

You need to create a Clerk application in your [Clerk Dashboard](https://dashboard.clerk.com/) and configure the application to use **Sign in with Metamask**. For more information on how to set up a Clerk application, check out our [setup guide](/docs/quickstarts/setup-clerk). To enable Metamask authentication, check out [this guide](/docs/authentication/configuration/sign-in-options#social-o-auth-web3).

## Creating a new Next.js app

Once you have a Clerk application set up in the dashboard, it's time to create a Next.js application. Clerk provides a detailed guide on how to [create a new Next.js app with Clerk](https://docs.clerk.dev/guides/nextjs).

## Requiring Web3 authentication

The easiest way to require authentication before showing a protected page is to use our Control Components:

[`​<SignedIn/>`](/docs/components/control/signed-in): Renders its children only when a user is signed in.
[`​<SignedOut/>`](/docs/components/control/signed-out): Renders its children only when there's no active user.

As a child of `<SignedOut/>`, we will include our [`<SignInWithMetamaskButton/>`](/docs/components/unstyled/sign-in-with-metamask) so the user can trigger the Metamask authentication flow.

The following example shows you how to compose our flexible [Control Components](/docs/components/overview) to build authentication flows that match your needs. Please note that you don't need to use any additional APIs, everything shown below is just Javascript.

```jsx filename="_app.js" copy
import '../styles/globals.css'
import { ClerkProvider, SignedIn, SignedOut, SignInWithMetamaskButton } from '@clerk/nextjs';
import { useRouter } from 'next/router';

//  List pages you want to be publicly accessible, or leave empty if
//  every page requires authentication. Use this naming strategy:
//   "/"              for pages/index.js
//   "/foo"           for pages/foo/index.js
//   "/foo/bar"       for pages/foo/bar.js
//   "/foo/[...bar]"  for pages/foo/[...bar].js
const publicPages = [];

function MyApp({ Component, pageProps }) {
  // Get the pathname
  const { pathname } = useRouter();

  // Check if the current route matches a public page
  const isPublicPage = publicPages.includes(pathname);

  // If the current route is listed as public, render it directly
  // Otherwise, use Clerk to require authentication
  return (
    <ClerkProvider>
      {isPublicPage ? (
        <Component {...pageProps} />
      ) : (
        <>
          <SignedIn>
            <Component {...pageProps} />
          </SignedIn>
          <SignedOut>
            <SignInWithMetamaskButton />
          </SignedOut>
        </>
      )}
    </ClerkProvider>
  );
}

export default MyApp;
```

Visit http://localhost:3000 to see your page. The home "/" page is not listed in the `publicPages` array, so you'll immediately see the **Sign in with Metamask** button - go ahead and try it!

## Hello, world!

After signing in with Metamask, you'll be presented with the Next.js default start screen. Let's update `pages/index.js` by adding a [`<UserButton />`](/docs/components/user/user-button) to retrieve the current users' Metamask address:

```jsx filename="pages/index.js" copy
import { UserButton, useUser } from "@clerk/nextjs";

export default function Home() {
  const { primaryWeb3Wallet } = useUser();
  return (
    <>
      <header
        style={{
          display: "flex",
          justifyContent: "space-between",
          padding: "1rem",
        }}
      >
        <span>My first DApp</span>
        <UserButton />
      </header>
      <main style={{ padding: "1rem" }}>
        <p>Address: {primaryWeb3Wallet.web3Wallet}</p>
      </main>
    </>
  );
}
```

## Accessing the Web3 address from the backend

### Add authentication to a serverless API route

A new Next.js app comes with a sample API route in `/pages/api/hello.js`. Let's modify it to retrieve the user's Web3 address:

```jsx filename="pages/api/hello.js" copy
import { requireSession } from "@clerk/nextjs/api";

export default requireSession(async (req, res) => {
  try {
    // SDK helpers for this request are coming soon!
    const user = await fetch(
      `https://api.clerk.com/v1/users/${req.session.userId}`,
      {
        headers: { Authorization: `Bearer ${process.env.CLERK_SECRET_KEY}` },
      }
    ).then((r) => r.json());

    // Retrieve the address
    const address = user.web3_wallets[0].web3_wallet;
    res.status(200).json({ address: address });
  } catch (e) {
    console.log(e);
    res.status(500).json({
      error: "Something went wrong retrieving the web3wallet from Clerk",
    });
  }
});
```

## Next steps

Now that you have Web3 authentication in a new Next.js application, and you know how to retrieve the user's Web3 address from both the frontend and the backend, you will want to read the following documentation:

<div className="container mx-auto my-4">
  <div className="grid grid-cols-1 gap-6 md:grid-cols-2">
    <Cards title="Customization & Localization" description="Learn how to customize and localize the Clerk components." link="/docs/components/customization/overview" cta="Learn More" />

    <Cards title="Authentication Components" description="Learn more about all our authentication components." link="/docs/components/overview" cta="Learn More" />

    <Cards title="Client Side Helpers" description="Learn more about our client side helpers and how to use them." link="/docs/references/nextjs/overview#client-side-helpers" cta="Learn More" />

    <Cards title="Next.js SDK Reference" description="Learn more about additional Next.js methods." link="/docs/references/nextjs/overview" cta="Learn More" />
  </div>
</div>