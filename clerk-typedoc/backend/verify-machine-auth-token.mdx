Verifies any type of machine token by detecting its type from the prefix.

## Parameters

| Parameter                    | Type                                                                                                                                                                                                                                                                    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `token`                      | `string`                                                                                                                                                                                                                                                                | The token to verify (e.g. starts with "m2m*", "oauth*", "api*key*", etc.)                                                                                                                                                                                                                                                                                                                                                                                                           |
| `options`                    | <code>\{ apiUrl?: string; apiVersion?: string; audience?: string \| string[]; authorizedParties?: string[]; clockSkewInMs?: number; headerType?: string \| string[]; jwksCacheTtlInMs?: number; jwtKey?: string; secretKey?: string; skipJwksCache?: boolean; \}</code> | Options including secretKey for BAPI authorization                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `options.apiUrl?`            | `string`                                                                                                                                                                                                                                                                | The [Clerk Backend API](/docs/reference/backend-api){{ target: '_blank' }} endpoint. Defaults to `'https://api.clerk.com'`.                                                                                                                                                                                                                                                                                                                                                         |
| `options.apiVersion?`        | `string`                                                                                                                                                                                                                                                                | The version passed to the Clerk API. Defaults to `'v1'`.                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `options.audience?`          | <code>string \| string[]</code>                                                                                                                                                                                                                                         | A string or list of [audiences](https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.3). If passed, it is checked against the `aud` claim in the token.                                                                                                                                                                                                                                                                                                                        |
| `options.authorizedParties?` | <code>string[]</code>                                                                                                                                                                                                                                                   | An allowlist of origins to verify against, to protect your application from the subdomain cookie leaking attack. Example: `['http://localhost:3000', 'https://example.com']`.                                                                                                                                                                                                                                                                                                       |
| `options.clockSkewInMs?`     | `number`                                                                                                                                                                                                                                                                | Specifies the allowed time difference (in milliseconds) between the Clerk server (which generates the token) and the clock of the user's application server when validating a token. Defaults to `5000`.                                                                                                                                                                                                                                                                            |
| `options.headerType?`        | <code>string \| string[]</code>                                                                                                                                                                                                                                         | A string or list of allowed [header types](https://datatracker.ietf.org/doc/html/rfc7515#section-4.1.9). Defaults to `'JWT'`.                                                                                                                                                                                                                                                                                                                                                       |
| `options.jwksCacheTtlInMs?`  | `number`                                                                                                                                                                                                                                                                | **Deprecated.** This cache TTL will be removed in the next major version. Specifying a cache TTL is a no-op.                                                                                                                                                                                                                                                                                                                                                                        |
| `options.jwtKey?`            | `string`                                                                                                                                                                                                                                                                | Used to verify the session token in a networkless manner. Supply the PEM public key from the **[**API keys**](https://dashboard.clerk.com/last-active?path=api-keys) page -> Show JWT public key -> PEM Public Key** section in the Clerk Dashboard. **It's recommended to use [the environment variable](/docs/guides/development/clerk-environment-variables) instead.** For more information, refer to [Manual JWT verification](/docs/guides/sessions/manual-jwt-verification). |
| `options.secretKey?`         | `string`                                                                                                                                                                                                                                                                | The Clerk Secret Key from the [**API keys**](https://dashboard.clerk.com/last-active?path=api-keys) page in the Clerk Dashboard.                                                                                                                                                                                                                                                                                                                                                    |
| `options.skipJwksCache?`     | `boolean`                                                                                                                                                                                                                                                               | A flag to ignore the JWKS cache and always fetch JWKS before each JWT verification.                                                                                                                                                                                                                                                                                                                                                                                                 |

## Returns

`Promise`\<<code>\{ data?: undefined; errors: \[MachineTokenVerificationError\]; tokenType: "api_key" \| "oauth_token" \| "m2m_token"; \} \| \{ data: [M2MToken](m2-m-token.mdx); errors?: undefined; tokenType: "api_key" \| "oauth_token" \| "m2m_token"; \} \| \{ data: IdPOAuthAccessToken; errors?: undefined; tokenType: "api_key" \| "oauth_token" \| "m2m_token"; \} \| \{ data: APIKey; errors?: undefined; tokenType: "api_key" \| "oauth_token" \| "m2m_token"; \}</code>\>
