---
title: '`getAuth()`'
description: The getAuth() helper retrieves authentication state from the request object.
---

The `getAuth()` helper retrieves authentication state from the `request` object. See the [Next.js reference documentation](/docs/references/nextjs/pages-router/get-auth) for more examples on how to use the returned `auth` object.

### `getAuth()` options

<Properties>
  - `request`

  The request object.

  ---

  - `opts?`
  - `{acceptsToken: TokenType, treatPendingAsSignedOut: boolean }`

  An optional object that can be used to configure the behavior of the `getAuth()` function. It accepts the following properties:

  <Include src="_partials/machine-auth/accepts-token-explanation" />

  - `treatPendingAsSignedOut?`: A boolean that indicates whether to treat [`pending` session status](/docs/references/javascript/types/session-status#properties) as signed out. Defaults to `true`.
</Properties>

### Example: Protect a route based on authorization status

The following example uses [`requireAuth()`](/docs/references/express/require-auth) to protect the route based on _authentication_ status, and then uses `getAuth()` to protect the route based on _authorization_ status.

```js
import { clerkMiddleware, getAuth, requireAuth } from '@clerk/express'
import express from 'express'

const app = express()
const PORT = 3000

// Apply `clerkMiddleware()` to all routes
app.use(clerkMiddleware())

// Use `getAuth()` to protect a route based on authorization status
const hasPermission = (req, res, next) => {
  const auth = getAuth(req)

  // Handle if the user is not authorized
  if (!auth.has({ permission: 'org:admin:example' })) {
    return res.status(403).send('Forbidden')
  }

  return next()
}

// Use `requireAuth()` to protect a route based on authentication status
// If user is not authenticated, requireAuth() will redirect back to the homepage
app.get('/path', requireAuth(), hasPermission, (req, res) => res.json(req.auth))

// Start the server and listen on the specified port
app.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`)
})
```

### Example: Protect a route based on token type

The following example uses `getAuth()` to protect the route based on token type:

- It accepts any token type `(acceptsToken: 'any')` from the request.
- If the token is a `session_token`, it logs that the request is from a user session.
- Otherwise, it logs that the request uses a machine token and specifies its type.

```js
import express from 'express'
import { getAuth } from '@clerk/express'

const app = express()

app.get('/path', (req, res) => {
  // Use `getAuth()` to protect a route based on token type
  const authObject = getAuth(req, { acceptsToken: 'any' })

  if (authObject.tokenType === 'session_token') {
    console.log('This is a session token from a user')
  } else {
    console.log(`This is a ${authObject.tokenType} token`)
  }
})
```
