---
title: Integrate Instant with Clerk
description: Learn how to integrate Clerk into your Instant application.
---

<TutorialHero
  beforeYouStart={[
    {
      title: "Set up a Clerk application",
      link: "/docs/quickstarts/setup-clerk",
      icon: "clerk",
    },
    {
      title: "Create an Instant database",
      link: "https://instantdb.com",
      icon: "cog-6-teeth",
    },
    {
      title: "Integrate the appropriate Clerk SDK in your local project",
      link: "/docs/quickstarts/overview",
      icon: "code-bracket",
    },
  ]}
>
  - Use Clerk to authenticate with Instant.
</TutorialHero>

Instant has a default integration with Clerk. With two updates in your configuration, you can use both Clerk's authentication and Instant's realtime database.

<Steps>
  ### Include the `email` claim in your Clerk session

  1. Go to your Clerk dashboard, and select **[Sessions](https://dashboard.clerk.com/last-active?path=sessions)**.
  1. In the **Customize session token** section, click **Edit**

  Add the email claim to your session token:

  ```json
  {
    "email": "{{user.primary_email_address}}"
  }
  ```

  You can have additional claims as long as the `email` claim is set to `{{user.primary_email_address}}`.

  ### Get your Clerk Publishable key

  1. In the Clerk dashboard, navigate to **[API keys](https://dashboard.clerk.com/last-active?path=api-keys)**,

  Copy the **Publishable key**. It should start with `pk_`.

  ### Register your Clerk Publishable key with Instant

  1. Go to the Instant dashboard, navigate to the **[Auth](https://www.instantdb.com/dash?t=auth)** tab

  Add a new clerk app with the **Publishable key** you copied.

  ### Use Instant with Clerk in your code

  Now that you have configured the integration, it's time to use Instant with Clerk in your code.

  The following example:

  - Uses Clerk's `getToken` helper to get the session for a signed in user
  - Calls Instant's `db.auth.signInWithIdToken` with the session and the client name you set on the Instant dashboard.

  When you call `db.auth.signInWithIdToken`, Instant will verify that the session was signed by your Clerk app. If verified, Instant use the email in the session's claims to lookup your user or create a new one and run a long-lived session.

  Be sure to call Instant's `db.auth.signOut` when you want to sign the user out.

  This example is written for Next.js App Router, but is supported by any React meta framework, such as Remix.

  ```tsx {{ filename: 'app/instant/page.tsx' }}
  'use client'

  import { useAuth, ClerkProvider, SignInButton, SignedIn, SignedOut } from '@clerk/next'
  import { init } from '@instantdb/react'
  import { useEffect } from 'react'

  // Your app id lives in https://instantdb.com/dash :)
  const APP_ID = '__APP_ID__'

  const db = init({ appId: APP_ID })

  // Use the clerk client name you set in the "Auth" tab
  const CLERK_CLIENT_NAME = 'REPLACE_ME'

  function ClerkSignedInComponent() {
    const { getToken, signOut } = useAuth()

    const signInToInstantWithClerkToken = async () => {
      // getToken gets the jwt from Clerk for your signed in user.
      const idToken = await getToken()

      if (!idToken) {
        // No jwt, can't sign in to instant
        return
      }

      // Create a long-lived session with Instant for your clerk user
      // It will look up the user by email or create a new user with
      // the email address in the session token.
      db.auth.signInWithIdToken({
        clientName: CLERK_CLIENT_NAME,
        idToken: idToken,
      })
    }

    useEffect(() => {
      signInToInstantWithClerkToken()
    }, [])

    const { isLoading, user, error } = db.useAuth()

    if (isLoading) {
      return <div>Loading...</div>
    }
    if (error) {
      return <div>Error signing in to Instant! {error.message}</div>
    }
    if (user) {
      return (
        <div>
          <p>Signed in with Instant through Clerk!</p>{' '}
          <button
            onClick={() => {
              // First sign out of Instant to clear the Instant session.
              db.auth.signOut().then(() => {
                // Then sign out of Clerk to clear the Clerk session.
                signOut()
              })
            }}
          >
            Sign out
          </button>
        </div>
      )
    }
    return (
      <div>
        <button onClick={signInToInstantWithClerkToken}>Sign in to Instant</button>
      </div>
    )
  }

  function App() {
    return (
      <ClerkProvider>
        <SignedOut>
          <SignInButton />
        </SignedOut>
        <SignedIn>
          <ClerkSignedInComponent />
        </SignedIn>
      </ClerkProvider>
    )
  }

  export default App
  ```
</Steps>
