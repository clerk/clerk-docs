---
title: Managing orgs skill
description: Build B2B multi-tenant apps with Clerk Organizations, roles, and permissions.
---

The `managing-orgs` skill helps AI agents build multi-tenant B2B applications with Clerk Organizations, including role-based access control (RBAC) and member management.

## Installation

```bash
npx skills add clerk/skills --skill managing-orgs
```

## Prerequisites

This skill requires basic Clerk authentication to be set up first. If you haven't set up auth yet, use the [adding-auth](/docs/guides/ai/skills/adding-auth) skill first.

## Enable organizations

1. Go to [Clerk Dashboard](https://dashboard.clerk.com/last-active?path=organizations) > Organizations > Settings
1. Enable Organizations
1. Configure roles and permissions

## Example prompts

- "Add organization support to my app"
- "Set up role-based access control"
- "Create an organization switcher component"
- "Add member invitations to my B2B app"
- "Protect routes based on organization membership"

## Default roles

| Role | Key | Permissions |
| - | - | - |
| Admin | `org:admin` | Full access |
| Member | `org:member` | Limited access |

## Common patterns

### Organization switcher

```tsx {{ filename: 'components/OrgSwitcher.tsx' }}
import { OrganizationSwitcher } from '@clerk/nextjs'

export function OrgSwitcher() {
  return (
    <OrganizationSwitcher
      afterCreateOrganizationUrl="/dashboard"
      afterSelectOrganizationUrl="/dashboard"
    />
  )
}
```

### Require organization in middleware

```ts {{ filename: 'middleware.ts' }}
import { clerkMiddleware, createRouteMatcher } from '@clerk/nextjs/server'

const isOrgRoute = createRouteMatcher(['/org/(.*)'])

export default clerkMiddleware(async (auth, req) => {
  if (isOrgRoute(req)) {
    const { orgId } = await auth()
    if (!orgId) {
      // Redirect to org selection
      return Response.redirect(new URL('/select-org', req.url))
    }
  }
})
```

### Role-based access check

```tsx {{ filename: 'app/settings/page.tsx' }}
import { auth } from '@clerk/nextjs/server'
import { redirect } from 'next/navigation'

export default async function SettingsPage() {
  const { has } = await auth()

  // Check if user has admin role
  const isAdmin = has({ role: 'org:admin' })

  if (!isAdmin) {
    redirect('/dashboard')
  }

  return <div>Admin Settings</div>
}
```

### Member list

```tsx {{ filename: 'components/MemberList.tsx' }}
'use client'

import { useOrganization } from '@clerk/nextjs'

export function MemberList() {
  const { organization, isLoaded } = useOrganization()

  if (!isLoaded || !organization) {
    return null
  }

  return (
    <div>
      <h2>Members of {organization.name}</h2>
      {/* Use organization.getMemberships() for full list */}
    </div>
  )
}
```

## Key hooks

```tsx
import { useOrganization, useOrganizationList } from '@clerk/nextjs'

const { organization, membership, isLoaded } = useOrganization()
const { setActive, userMemberships } = useOrganizationList()
```

## Common pitfalls

- **Create sign-in/sign-up pages** - middleware's `redirectToSignIn()` expects a `/sign-in` route
- **Enable Organizations in Dashboard first** - the feature must be enabled
- **Check `isLoaded` and `organization`** before accessing org data
- **Use role keys not names** - `org:admin` not `Admin`
- **Use `has()` for RBAC** - not `orgRole` string comparison
- **Check auth before org context** in middleware

## Related skills

- [syncing-users](/docs/guides/ai/skills/syncing-users) - Sync organization data to your database
- [nextjs-patterns](/docs/guides/ai/skills/nextjs-patterns) - Advanced middleware patterns

## Source code

View the skill source on [GitHub](https://github.com/clerk/skills/tree/main/skills/managing-orgs).
