import { Tab, Tabs } from "nextra-theme-docs";
import { Tables } from "@/components/Table";
import { Images } from "@/components/Images";
import { CodeBlockTabs } from "@/components/CodeBlockTabs";

# First Factor

These are all methods on [the `SignIn` class](/reference-js/sign-in/sign-in) that allow you to handle the second factor of a multi-factor authentication flow.

## `prepareSecondFactor()`

```typescript
function prepareSecondFactor(params: PrepareSecondFactorParams): Promise<SignIn>;
```

Begins the second factor verification process. This step is optional in order to complete a sign in.

A common scenario for the second step verification (2FA) is to require a one-time code (OTP) as proof of identity. This is determined by the accepted `strategy` parameter values. Each authentication identifier supports different strategies.

> While the `phone_code` strategy requires preparation, the `totp` strategy does not - the user can directly attempt the second factor verification in that case.

### `PrepareSecondFactorParams`

<Tables
    headings={['Name', 'Type', 'Description']}
    headingsMeta={[{}, {}, {maxWidth: "300px"}]}
    rows={[{cells: [
        <code>strategy</code>,
        <code>string</code>,
        <>
        The strategy used for verification. Each authentication identifier supports different verification strategies. Possible strategy values for second factor preparation are:
        <ul>
        <li><strong><code>phone_code</code></strong>: User will receive a one-time authentication code in their phone, via SMS. The SMS message will be sent to the user's phone number that was added when setting up 2FA.</li>
        </ul>
        </>
        ]}
    ]}
/>

### Returns


<Tables
    headings={['Type', 'Description']}
    headingsMeta={[{}, {maxWidth: "300px"}]}
    rows={[{cells: [
        <code>Promise{"<"}<a href="/reference-js/sign-in/sign-in">SignIn</a>{">"}</code>,
        <>
        This method returns a <code>Promise</code> which resolves with a <a href="/reference-js/sign-in/sign-in"><code>SignIn</code></a> object. Check the <code>secondFactorVerification</code> attribute for the status of the second factor verification process.
        </>
        ]}
    ]}
/>

## `attemptSecondFactor()`

```typescript
function attemptSecondFactor(params: AttemptSecondFactorParams): Promise<SignIn>;
```

Attempts to complete the second factor verification process (2FA). This step is optional in order to complete a sign in.

For the `phone_code` strategy, make sure that a verification has already been prepared before you call this method, by first calling `SignIn.prepareSecondFactor`. Depending on the strategy that was selected when the verification was prepared, the method parameters should be different.

The `totp` strategy can directly be attempted, without the need for preparation.

### `AttemptSecondFactorParams`

<Tables
    headings={['Name', 'Type', 'Description']}
    headingsMeta={[{}, {}, {maxWidth: "300px"}]}
    rows={[{cells: [
        <code>strategy</code>,
        <code>string</code>,
        <>
        The strategy to be used for second factor verification. Possible <code>strategy</code> values are
        <ul>
        <li><strong><code>phone_code</code></strong>: User will receive a one-time authentication code in their phone, via SMS. At least one phone number should be on file for the user.</li>
        <li><strong><code>totp</code></strong>: User must provide a 6-digit TOTP code generated by their authenticator app. The user will need to have created a TOTP secret beforehand so as to register it on their authentictor app via QR code, URI or even entering the secret itself.</li>
        </ul>
        </>
        ]},
        {cells: [
            <code>code</code>,
            <code>string</code>,
            <>
            For the <code>phone_code</code> strategy: The one-time code that was sent to the user as part of the prepareSecondFactor step.<br />
            For the <code>totp</code> strategy: The TOTP generated by the user's authenticator app.
            </>
        ]}
    ]}
/>

### Returns


<Tables
    headings={['Type', 'Description']}
    headingsMeta={[{}, {maxWidth: "300px"}]}
    rows={[{cells: [
        <code>Promise{"<"}<a href="/reference-js/sign-in/sign-in">SignIn</a>{">"}</code>,
        <>
        This method returns a <code>Promise</code> which resolves with a <a href="/reference-js/sign-in/sign-in"><code>SignIn</code></a> object. Check the <code>secondFactorVerification</code> attribute for the status of the second factor verification process.
        </>
        ]}
    ]}
/>