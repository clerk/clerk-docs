---
title: '`getAuth()`'
description: The getAuth() helper retrieves the current user's authentication state from the request object.
sdk: fastify
---

The `getAuth()` helper retrieves the current user's authentication state from the `request` object. It returns the [`Auth` object](/docs/reference/backend/types/auth-object){{ target: '_blank' }}. See the [Next.js reference documentation](/docs/reference/nextjs/pages-router/get-auth){{ target: '_blank' }} for more examples on how to use the returned `Auth` object.

### `getAuth()` options

<Properties>
  - `request`

  The request object.

  ---

  - `opts?`
  - `{acceptsToken: TokenType, treatPendingAsSignedOut: boolean }`

  An optional object that can be used to configure the behavior of the `getAuth()` function. It accepts the following properties:

  <Include src="_partials/machine-auth/accepts-token-explanation" />

  - `treatPendingAsSignedOut?`: A boolean that indicates whether to treat [`pending` session status](/docs/reference/javascript/types/session-status#properties) as signed out. Defaults to `true`.
</Properties>

### Example: Use `getAuth()` to retrieve the `userId`

<Include src="_partials/fastify/get-auth" />

For examples on how to use `getAuth()` to perform [authorization checks](!authorization-check), see the [dedicated guide](/docs/guides/secure/authorization-checks).

### Example: Protect a route based on token type

The following example uses `getAuth()` to protect the route based on token type:

- It accepts any token type `(acceptsToken: 'any')` from the request.
- If the token is a `session_token`, it logs that the request is from a user session.
- Otherwise, it logs that the request uses a machine token and specifies its type.

```ts
import Fastify from 'fastify'
import { getAuth } from '@clerk/fastify'

const fastify = Fastify()

fastify.get('/path', (request, reply) => {
  // Use `getAuth()` to protect a route based on token type
  const authObject = getAuth(req, { acceptsToken: 'any' })

  if (authObject.tokenType === 'session_token') {
    console.log('This is a session token from a user')
  } else {
    console.log(`This is a ${authObject.tokenType} token`)
  }
})
```
